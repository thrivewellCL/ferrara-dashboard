<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ferrara Group ‚Äî Real Estate Dashboard</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Segoe UI',system-ui,sans-serif;background:#0d1b2e;color:#e8eaf0;min-height:100vh}
.top-bar{background:linear-gradient(135deg,#0d1b2e 0%,#1a2d4a 100%);border-bottom:2px solid #c9a84c;padding:16px 32px;display:flex;align-items:center;justify-content:space-between}
.logo{font-size:22px;font-weight:700;color:#c9a84c;letter-spacing:1px}
.logo span{color:#fff;font-weight:300}
.timestamp{color:#8899aa;font-size:13px}
.tabs{display:flex;background:#0d1b2e;border-bottom:1px solid #1e3a5f;padding:0 24px;overflow-x:auto;gap:4px}
.tab-btn{padding:14px 20px;cursor:pointer;border:none;background:transparent;color:#8899aa;font-size:14px;font-weight:500;border-bottom:3px solid transparent;white-space:nowrap;transition:all .2s}
.tab-btn:hover{color:#c9a84c}
.tab-btn.active{color:#c9a84c;border-bottom-color:#c9a84c}
.tab-content{display:none;padding:28px 32px;max-width:1400px;margin:0 auto}
.tab-content.active{display:block}
.kpi-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:20px;margin-bottom:28px}
.kpi-card{background:#13253d;border-radius:12px;padding:24px;border:1px solid #1e3a5f;position:relative;overflow:hidden}
.kpi-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,#c9a84c,#f0c040)}
.kpi-label{font-size:12px;color:#8899aa;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px}
.kpi-value{font-size:32px;font-weight:700;color:#fff}
.kpi-sub{font-size:13px;color:#8899aa;margin-top:6px}
.kpi-green .kpi-value{color:#4ade80}
.kpi-red .kpi-value{color:#f87171}
.kpi-gold .kpi-value{color:#c9a84c}
.card{background:#13253d;border-radius:12px;padding:24px;border:1px solid #1e3a5f;margin-bottom:20px}
.card-title{font-size:16px;font-weight:600;color:#c9a84c;margin-bottom:16px;display:flex;align-items:center;gap:8px}
.chart-row{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px}
.chart-card{background:#13253d;border-radius:12px;padding:24px;border:1px solid #1e3a5f;position:relative;min-height:440px}
.chart-title{font-size:14px;font-weight:600;color:#c9a84c;margin-bottom:16px}
.warning-banner{background:#2d1a0e;border:1px solid #f59e0b;border-radius:10px;padding:16px 20px;margin-bottom:24px;display:flex;align-items:center;gap:12px;cursor:pointer}
.warning-banner:hover{background:#3d2a1e}
.warning-text{color:#fbbf24;font-weight:600}
.warning-sub{color:#d97706;font-size:13px}
.progress-bar-wrap{background:#0d1b2e;border-radius:10px;padding:16px;margin-bottom:24px;border:1px solid #1e3a5f}
.progress-label{font-size:13px;color:#8899aa;margin-bottom:8px}
.progress-track{background:#fff;border-radius:6px;height:10px;overflow:hidden}
.progress-fill{height:100%;border-radius:6px;background:linear-gradient(90deg,#c9a84c,#4ade80)}
.data-table{width:100%;border-collapse:collapse;font-size:13px}
.data-table th{background:#0d1b2e;color:#c9a84c;padding:10px 12px;text-align:left;font-size:12px;text-transform:uppercase;letter-spacing:.5px;border-bottom:1px solid #1e3a5f;position:sticky;top:0;z-index:5}
.data-table td{padding:9px 12px;border-bottom:1px solid #1a2d4a;vertical-align:middle}
.data-table tr:hover td{background:#1a2d4a}
.data-table tr.needs-review td{background:#2d1f0e}
.data-table tr.income td{background:#0e2d1a}
.badge{display:inline-block;padding:2px 10px;border-radius:20px;font-size:11px;font-weight:600;text-transform:uppercase}
.badge-red{background:#3d0e0e;color:#f87171;border:1px solid #7f1d1d}
.badge-green{background:#0e2d1a;color:#4ade80;border:1px solid #14532d}
.badge-blue{background:#0e1d3d;color:#60a5fa;border:1px solid #1e3a7f}
.badge-amber{background:#2d1f0e;color:#fbbf24;border:1px solid #7f4d0e}
.badge-gold{background:#2d230e;color:#c9a84c;border:1px solid #7f5d0e}
.badge-gray{background:#1a2d4a;color:#8899aa;border:1px solid #2d3d5a}
.prop-card{background:#13253d;border-radius:12px;padding:24px;border:1px solid #1e3a5f;margin-bottom:20px;position:relative}
.prop-card.green-card{border-left:4px solid #4ade80}
.prop-card.amber-card{border-left:4px solid #fbbf24}
.prop-card.red-card{border-left:4px solid #f87171}
.prop-name{font-size:18px;font-weight:700;color:#c9a84c;margin-bottom:4px}
.prop-address{font-size:13px;color:#8899aa;margin-bottom:16px}
.prop-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px}
.prop-stat{background:#0d1b2e;border-radius:8px;padding:12px}
.prop-stat-label{font-size:11px;color:#8899aa;text-transform:uppercase;letter-spacing:.5px}
.prop-stat-value{font-size:18px;font-weight:700;color:#fff;margin-top:4px}
.prop-stat-value.income{color:#4ade80}
.prop-stat-value.expense{color:#f87171}
.prop-stat-value.noi-pos{color:#4ade80}
.prop-stat-value.noi-neg{color:#f87171}
.opt-card{background:#13253d;border-radius:12px;padding:20px;border:1px solid #1e3a5f;margin-bottom:16px;display:flex;gap:16px;align-items:flex-start}
.opt-card.urgent{border-left:4px solid #f87171}
.opt-card.savings{border-left:4px solid #4ade80}
.opt-card.reminder{border-left:4px solid #60a5fa}
.opt-card.warn{border-left:4px solid #fbbf24}
.opt-icon{font-size:24px;flex-shrink:0}
.opt-body{flex:1}
.opt-title{font-size:15px;font-weight:700;color:#fff;margin-bottom:6px}
.opt-desc{font-size:13px;color:#8899aa;line-height:1.6}
.opt-savings{font-size:13px;color:#4ade80;font-weight:600;margin-top:8px}
.opt-action{font-size:12px;color:#60a5fa;margin-top:6px}
.review-group{margin-bottom:28px}
.review-group-title{font-size:15px;font-weight:700;color:#fff;margin-bottom:12px;padding:10px 16px;background:#0d1b2e;border-radius:8px;display:flex;align-items:center;gap:8px}
.review-row{background:#13253d;border-radius:8px;padding:14px 16px;margin-bottom:8px;border:1px solid #1e3a5f;position:relative}
.review-row.edited{border-left:4px solid #60a5fa}
.review-row-header{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
.review-date{font-size:12px;color:#8899aa;min-width:80px}
.review-desc{font-size:14px;font-weight:600;color:#fff;flex:1}
.review-amount{font-size:15px;font-weight:700;color:#f87171;min-width:80px;text-align:right}
.review-why{font-size:12px;color:#fbbf24;margin-top:8px;padding:8px 12px;background:#2d1f0e;border-radius:6px}
.review-edit-row{margin-top:10px;display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.review-select{background:#0d1b2e;border:1px solid #2d3d5a;color:#e8eaf0;border-radius:6px;padding:5px 8px;font-size:12px}
.review-input{background:#0d1b2e;border:1px solid #2d3d5a;color:#e8eaf0;border-radius:6px;padding:5px 8px;font-size:12px;width:200px}
.review-btn{background:#fff;border:1px solid #2d5a8f;color:#e8eaf0;border-radius:6px;padding:5px 12px;font-size:12px;cursor:pointer}
.review-btn:hover{background:#2d4a6f}
.review-btn.resolve{background:#0e2d1a;border-color:#14532d;color:#4ade80}
.resolve-btn:hover{background:#1e4d2a}
.pending-counter{background:#c9a84c;color:#0d1b2e;border-radius:20px;padding:4px 14px;font-size:13px;font-weight:700;display:inline-block;margin-right:12px}
.copy-btn{background:#fff;border:1px solid #2d5a8f;color:#60a5fa;border-radius:8px;padding:8px 16px;font-size:13px;font-weight:600;cursor:pointer}
.copy-btn:hover{background:#2d4a6f}
.section-header-row{display:flex;align-items:center;gap:12px;margin-bottom:20px;flex-wrap:wrap}
.filter-row{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:20px;align-items:center}
.filter-btn{background:#13253d;border:1px solid #1e3a5f;color:#8899aa;border-radius:6px;padding:6px 14px;font-size:12px;cursor:pointer}
.filter-btn.active{background:#fff;color:#c9a84c;border-color:#c9a84c}
.filter-btn:hover{color:#c9a84c}
.search-input{background:#13253d;border:1px solid #1e3a5f;color:#e8eaf0;border-radius:6px;padding:7px 14px;font-size:13px;min-width:240px}
.search-input:focus{outline:none;border-color:#c9a84c}
.table-wrap{overflow-x:auto;border-radius:10px;border:1px solid #1e3a5f}
.total-row td{font-weight:700;color:#c9a84c;background:#0d1b2e !important;border-top:2px solid #2d3d5a}
.utility-group-header{background:#0d1b2e;color:#c9a84c;font-size:13px;font-weight:700;padding:10px 12px;text-transform:uppercase;letter-spacing:.5px}
.collapsible-toggle{cursor:pointer;user-select:none}
.collapsible-toggle:hover{color:#c9a84c}
.collapsible-content{display:none}
.collapsible-content.open{display:block}
.how-to-card{background:#13253d;border-radius:12px;padding:28px;border:1px solid #1e3a5f;margin-bottom:20px}
.how-to-title{font-size:18px;font-weight:700;color:#c9a84c;margin-bottom:6px}
.how-to-sub{font-size:13px;color:#8899aa;margin-bottom:20px}
.step-list{list-style:none}
.step-list li{display:flex;gap:14px;margin-bottom:14px;padding:12px 16px;background:#0d1b2e;border-radius:8px;align-items:flex-start}
.step-num{background:#c9a84c;color:#0d1b2e;border-radius:50%;width:26px;height:26px;display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:700;flex-shrink:0}
.step-text{font-size:13px;color:#e8eaf0;line-height:1.6}
.step-text strong{color:#c9a84c}
.income-source-list{list-style:none}
.income-source-list li{padding:8px 16px;border-bottom:1px solid #1a2d4a;font-size:13px;color:#e8eaf0}
.income-source-list li:last-child{border-bottom:none}
.income-source-list span{color:#4ade80;font-weight:600;float:right}
.note-banner{background:#0e1d3d;border:1px solid #1e3a7f;border-radius:8px;padding:12px 16px;font-size:13px;color:#60a5fa;margin-bottom:16px}
.warn-row td{background:#3d2a0e !important}
.warn-row td:first-child::before{content:"‚ö†Ô∏è ";font-size:12px}
canvas{max-height:320px}
@media(max-width:768px){.chart-row{grid-template-columns:1fr}.kpi-grid{grid-template-columns:1fr 1fr}.tab-btn{padding:10px 14px;font-size:12px}}

/* ‚îÄ‚îÄ Overview White Theme ‚îÄ‚îÄ */
#tab-overview { background:#f0f4f8; padding:20px; border-radius:12px; }
#tab-overview .kpi-card { background:#fff !important; border:1px solid #e2e8f0 !important; box-shadow:0 2px 8px rgba(0,0,0,0.08); }
#tab-overview .kpi-label { color:#64748b !important; }
#tab-overview .kpi-value { color:#1e293b !important; }
#tab-overview .kpi-sub { color:#64748b !important; }
#tab-overview .kpi-section-label { color:#1e293b !important; }
#tab-overview .card { background:#fff !important; border:1px solid #e2e8f0 !important; box-shadow:0 2px 8px rgba(0,0,0,0.08); }
#tab-overview .card-title { color:#1e3a5f !important; }
#tab-overview .chart-card { background:#fff !important; border:1px solid #e2e8f0 !important; box-shadow:0 2px 8px rgba(0,0,0,0.08); }
#tab-overview .warning-banner { background:linear-gradient(135deg,#fef3c7,#fde68a) !important; border:1px solid #f59e0b !important; }
#tab-overview .warning-text { color:#92400e !important; }
#tab-overview .warning-sub { color:#78350f !important; }
#tab-overview .progress-bar-wrap { background:#fff !important; border:1px solid #e2e8f0 !important; }
#tab-overview .progress-label { color:#475569 !important; }


#tab-overview .kpi-income .kpi-value { color:#16a34a !important; }
#tab-overview .kpi-expense .kpi-value { color:#dc2626 !important; }
#tab-overview .kpi-net .kpi-value { color:#b45309 !important; }


.chart-addenda, .addenda-strip, .chart-legend-strip {
    color: #333 !important;
    background: #f5f5f5 !important;
}
.chart-addenda *, .addenda-strip *, .chart-legend-strip * {
    color: #333 !important;
}


#expenseDonut, #vendorPieChart {
    width: 380px !important;
    height: 380px !important;
}

</style>

<style>
#pw-overlay{position:fixed;inset:0;background:#0d1b2e;z-index:9999;display:flex;align-items:center;justify-content:center}
#pw-box{background:#13253d;border:1px solid #c9a84c;border-radius:16px;padding:48px 40px;text-align:center;max-width:400px;width:90%}
#pw-logo{font-size:26px;font-weight:700;color:#c9a84c;margin-bottom:8px}
#pw-sub{color:#8899aa;font-size:14px;margin-bottom:32px}
#pw-input{width:100%;padding:12px 16px;border-radius:8px;border:1px solid #1e3a5f;background:#0d1b2e;color:#fff;font-size:16px;margin-bottom:16px;outline:none;text-align:center;letter-spacing:2px}
#pw-input:focus{border-color:#c9a84c}
#pw-btn{width:100%;padding:12px;border-radius:8px;background:linear-gradient(135deg,#c9a84c,#f0c040);border:none;color:#0d1b2e;font-weight:700;font-size:15px;cursor:pointer}
#pw-btn:hover{opacity:0.9}
#pw-error{color:#f87171;font-size:13px;margin-top:12px;display:none}
#main-content{display:none}
</style>
</head>
<body>
<div id="pw-overlay">
  <div id="pw-box">
    <div id="pw-logo">üè† ThriveWell Co-Living</div>
    <div id="pw-sub">Real Estate Dashboard ‚Äî Secure Access</div>
    <input id="pw-input" type="password" placeholder="Enter password" onkeydown="if(event.key==='Enter')checkPw()">
    <button id="pw-btn" onclick="checkPw()">Unlock Dashboard</button>
    <div id="pw-error">Incorrect password. Please try again.</div>
  </div>
</div>
<div id="main-content">

<div class="top-bar">
  <div class="logo">Ferrara Group <span>Real Estate Dashboard</span></div>
  <div class="timestamp">üìÖ As of Feb 24, 2026 ¬∑ Data partially complete (Feb checking pending)</div>
</div>
<div class="tabs">
  <button class="tab-btn active" onclick="showTab('overview')">üìä Overview</button><button class="tab-btn" onclick="showTab('propertycharts')">üè† Property Charts</button>
  <button class="tab-btn" onclick="showTab('properties')">üè† Properties P&L</button>
  <button class="tab-btn" onclick="showTab('expenses')">üí∏ Expenses</button>
  <button class="tab-btn" onclick="showTab('utilities')">‚ö° Utilities</button>
  <button class="tab-btn" onclick="showTab('vendors')">ü§ù Vendors</button>
  <button class="tab-btn" onclick="showTab('review')" id="tab-review">üî¥ Needs Review</button>
  <button class="tab-btn" onclick="showTab('optimize')">üí∞ Optimize</button>
  
  <button class="tab-btn" onclick="showTab('howto')">üìã How to Update</button>
</div>


<!-- OVERVIEW TAB -->
<div id="tab-overview" class="tab-content active">
  <div class="warning-banner" onclick="showTab('review')">
    <span style="font-size:24px">‚ö†Ô∏è</span>
    <div>
      <div class="warning-text">Transactions Need Review ‚Äî Click to Resolve</div>
      <div class="warning-sub">Multiple items need property assignment ¬∑ Amazon charges (82) ¬∑ Unusual amounts ¬∑ Duplicate billing detected</div>
    </div>
    <span style="margin-left:auto;color:#444;font-weight:700">View All ‚Üí</span>
  </div>

  <div class="progress-bar-wrap">
    <div class="progress-label">üìÇ Data Completeness: Jan 2026 ‚úÖ Complete &nbsp;|&nbsp; Feb 2026 ‚ö†Ô∏è Checking statement not yet received ¬∑ PadSplit thru 2/24 only ¬∑ Airbnb payouts arrive in March</div>
    <div class="progress-track"><div class="progress-fill" style="width:65%"></div></div>
    <div style="font-size:12px;color:#8899aa;margin-top:6px">~65% complete for Feb 2026 ‚Äî income figures are estimates; expense totals will update when Feb checking arrives</div>
  </div>

  <!-- KPI Section Header styles -->
  <style>
    .kpi-section-label{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:2px;color:#8899aa;margin:0 0 12px 4px;padding-left:4px;border-left:3px solid #c9a84c}
    .kpi-grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin-bottom:10px}
    @media(max-width:768px){.kpi-grid-3{grid-template-columns:1fr}}
    .kpi-divider{border:none;border-top:1px solid #1e3a5f;margin:20px 0 18px}
  </style>

  <!-- CURRENT MONTH -->
  <div class="kpi-section-label">üìÖ Current Month ‚Äî February 2026 (est.)</div>
  <div class="kpi-grid-3">
    <div class="kpi-card kpi-green">
      <div class="kpi-label">Income</div>
      <div class="kpi-value">$42,377</div>
      <div class="kpi-sub">PadSplit $16,237 ¬∑ LTR $8,516 ¬∑ Grandview $8,638 ¬∑ est. pending Feb statement</div>
    </div>
    <div class="kpi-card kpi-red">
      <div class="kpi-label">Expenses</div>
      <div class="kpi-value">~$18,200</div>
      <div class="kpi-sub">Mortgages $13,812 ¬∑ utilities + vendors est. ¬∑ ‚ö†Ô∏è Feb statement pending</div>
    </div>
    <div class="kpi-card kpi-gold">
      <div class="kpi-label">Net Revenue</div>
      <div class="kpi-value">~$24,177</div>
      <div class="kpi-sub">Estimate only ¬∑ will update when Feb checking arrives</div>
    </div>
  </div>

  <hr class="kpi-divider">

  <!-- YEAR TO DATE -->
  <div class="kpi-section-label">üìä Year-to-Date 2026 ‚Äî Jan + Feb</div>
  <div class="kpi-grid-3">
    <div class="kpi-card kpi-green">
      <div class="kpi-label">YTD Income</div>
      <div class="kpi-value">$79,240</div>
      <div class="kpi-sub">Jan $36,863 ¬∑ Feb $42,377 est.</div>
    </div>
    <div class="kpi-card kpi-red">
      <div class="kpi-label">YTD Expenses</div>
      <div class="kpi-value">~$49,747</div>
      <div class="kpi-sub">Jan $31,547 ¬∑ Feb ~$18,200 est.</div>
    </div>
    <div class="kpi-card kpi-gold">
      <div class="kpi-label">YTD Net Revenue</div>
      <div class="kpi-value">~$29,493</div>
      <div class="kpi-sub">Jan $5,316 confirmed ¬∑ Feb est. ¬∑ updates when Feb data complete</div>
    </div>
  </div>

  <div class="note-banner">‚ÑπÔ∏è <strong>Note:</strong> Income totals are partially unassigned. PadSplit Feb numbers are through 2/24. Airbnb Feb payouts mostly arrive in March. Inter-company transfer ($7,500) and furniture reimbursement ($200) excluded from income.</div>

  
    <!-- Monthly Income / Expenses / Profit -->
    <div class="chart-card" style="margin-bottom:20px">
      <div class="chart-title">üìà Monthly P&L Summary ‚Äî Income vs Expenses vs Profit</div>
      <canvas id="monthlyPLChart" style="min-height:380px;width:100%"></canvas>
        <div style="display:flex;flex-wrap:wrap;gap:12px 20px;margin-top:14px;padding:10px 14px;background:#f8f9fb;border-radius:8px;border:1px solid #e8eaf0;">
          <div style="display:flex;align-items:center;gap:8px;font-size:12px;color:#444;">
            <div style="width:16px;height:12px;background:#22c55e;border-radius:3px;flex-shrink:0;"></div>
            <span><strong>Green Bars &#x2191;</strong> &mdash; Gross income collected that month</span>
          </div>
          <div style="display:flex;align-items:center;gap:8px;font-size:12px;color:#444;">
            <div style="width:16px;height:12px;background:#dc2626;border-radius:3px;flex-shrink:0;"></div>
            <span><strong>Red Bars &#x2193;</strong> &mdash; Total operating expenses (shown below zero axis)</span>
          </div>
          <div style="display:flex;align-items:center;gap:8px;font-size:12px;color:#444;">
            <div style="width:20px;height:3px;background:#3b82f6;border-radius:2px;flex-shrink:0;margin:4px 0;"></div>
            <span><strong>Blue Line</strong> &mdash; Cumulative YTD net cash flow (running total after mortgages)</span>
          </div>
          <div style="display:flex;align-items:center;gap:8px;font-size:12px;color:#444;">
            <div style="width:16px;height:12px;background:#86efac;border-radius:3px;flex-shrink:0;opacity:0.6;"></div>
            <span><strong>Ghost Bars</strong> &mdash; Visual depth overlay (same values, lighter shade for 3D effect)</span>
          </div>
        </div>
    </div>

    <div class="chart-row">
    <div class="chart-card">
      <div class="chart-title">üìà Income vs Expenses by Property (Jan 2026)</div>
      <canvas id="propIncomeChart" style="min-height:380px;width:100%"></canvas>
    </div>
    <div class="chart-card">
      <div class="chart-title">üç© Expense Breakdown by Category</div>
      <div style="display:flex;justify-content:center;align-items:center;"><div style="display:flex;justify-content:center;align-items:center;"><canvas id="expenseDonut" style="width:500px!important;height:500px!important;max-width:500px;max-height:500px" style="width:500px!important;height:500px!important;max-width:500px;max-height:500px"></canvas></div></div>
    </div>
  </div>
  <!-- Revenue by Platform Pie Chart -->
  <div class="chart-row" style="margin-bottom:20px">
    <div class="chart-card">
      <div class="chart-title">ü•ß Revenue by Platform ‚Äî YTD 2026</div>
      <div style="display:flex;justify-content:center;align-items:center;"><canvas id="vendorPieChart" style="width:380px!important;height:380px!important;max-width:380px;max-height:380px"></canvas></div>
    </div>
    <div class="chart-card">
      <div class="chart-title">üìä PadSplit Income ‚Äî Jan vs Feb 2026</div>
      <canvas id="padsplitChart" style="min-height:380px;width:100%"></canvas>
    </div>
  </div>
  <div class="chart-row" style="display:none">
    <div class="chart-card">
      <div class="chart-title">üìä PadSplit Income ‚Äî Jan vs Feb 2026 (hidden duplicate placeholder)</div>
      <canvas id="padsplitChartDupe" style="min-height:380px;width:100%"></canvas>
    </div>
    <div class="chart-card">
      <div class="chart-title">‚ö° Monthly Utility Costs by Property</div>
      <canvas id="utilityChart" style="min-height:380px;width:100%"></canvas>
    </div>
  </div>
</div>


<!-- EXPENSES TAB -->
<div id="tab-expenses" class="tab-content">

  <!-- Stacked Expense Chart: By Property & Category -->
  <div style="background:#1e2433;border-radius:14px;padding:22px 24px;margin-bottom:28px;border:1px solid #2d3448;">
    <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px;margin-bottom:18px;">
      <div>
        <h3 style="color:#f1f5f9;margin:0 0 4px 0;font-size:17px;">üìä Expenses by Property &amp; Category</h3>
        <div style="color:#94a3b8;font-size:12px;">Stacked view ‚Äî each bar = one property, color = expense category</div>
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap;">
        <button onclick="setStackView('monthly')" id="btnStackMonthly"
          style="padding:7px 16px;border-radius:20px;border:none;cursor:pointer;font-size:12px;font-weight:600;background:#3b82f6;color:#fff;">Monthly</button>
        <button onclick="setStackView('annual')" id="btnStackAnnual"
          style="padding:7px 16px;border-radius:20px;border:none;cursor:pointer;font-size:12px;font-weight:600;background:#2d3448;color:#94a3b8;">Annual</button>
      </div>
    </div>
    <div style="position:relative;height:360px;">
      <canvas id="stackedExpenseChart" style="width:100%;height:100%;"></canvas>
    </div>
    <!-- Legend -->
    <div id="stackedExpLegend" style="display:flex;flex-wrap:wrap;gap:8px 16px;margin-top:14px;padding:10px 14px;background:#161b2a;border-radius:8px;border:1px solid #2d3448;"></div>
    <!-- Addenda -->
    <div style="display:flex;flex-wrap:wrap;gap:10px 20px;margin-top:10px;padding:10px 14px;background:#0f1421;border-radius:8px;border:1px solid #2d3448;">
      <div style="font-size:11px;color:#64748b;"><strong style="color:#94a3b8;">Each bar</strong> = one investment property (excludes primary residence &amp; inactive)</div>
      <div style="font-size:11px;color:#64748b;"><strong style="color:#94a3b8;">Colors</strong> = expense category stacked within each property bar</div>
      <div style="font-size:11px;color:#64748b;"><strong style="color:#94a3b8;">Monthly view</strong> = Jan &amp; Feb 2026 side-by-side per property</div>
      <div style="font-size:11px;color:#64748b;"><strong style="color:#94a3b8;">Annual view</strong> = YTD totals per property (all months combined)</div>
      <div style="font-size:11px;color:#64748b;"><strong style="color:#94a3b8;">Hover</strong> = see exact $ amount per category per property</div>
    </div>
  </div>

  <h2 style="color:#c9a84c;margin-bottom:16px">üí∏ All Transactions</h2>
  <div class="filter-row">
    <input class="search-input" id="expSearch" placeholder="üîç Search description..." oninput="filterExpenses()">
    <button class="filter-btn active" onclick="filterExpMonth(this,'all')">All Months</button>
    <button class="filter-btn" onclick="filterExpMonth(this,'2025-12')">Dec 2025</button>
    <button class="filter-btn" onclick="filterExpMonth(this,'2026-01')">Jan 2026</button>
    <button class="filter-btn" onclick="filterExpMonth(this,'2026-02')">Feb 2026</button>
    <select class="review-select" id="expCatFilter" onchange="filterExpenses()" style="padding:7px 10px;font-size:13px">
      <option value="">All Categories</option>
      <option>Mortgage/Loan Payments</option><option>Utilities - Electric</option><option>Utilities - Water</option>
      <option>Utilities - Gas</option><option>Utilities - Internet</option><option>Utilities - Solar</option>
      <option>Cleaning</option><option>Landscaping &amp; Junk Removal</option><option>Repairs &amp; Labor</option>
      <option>Materials &amp; Supplies</option><option>Furnishings</option><option>Marketing &amp; Photography</option>
      <option>Legal &amp; Professional</option><option>Insurance</option><option>Software &amp; Tech</option>
      <option>Travel</option><option>Phone</option><option>Personal</option><option>Bank Fees &amp; Interest</option>
      <option>VA &amp; Staff</option><option>Business General</option><option>Rent Income</option>
    </select>
    <select class="review-select" id="expPropFilter" onchange="filterExpenses()" style="padding:7px 10px;font-size:13px">
      <option value="">All Properties</option>
      <option>Mesa Unit 32</option><option>13th Ave</option><option>5th Dr</option><option>38th Dr</option>
      <option>Janice Way</option><option>Grandview</option><option>25th St</option><option>Personal</option><option>Unassigned</option>
    </select>
  </div>
  <div class="table-wrap">
  <table class="data-table" id="expTable">
    <thead><tr>
      <th>Date</th><th>Description</th><th>Amount</th><th>Category</th><th>Property</th><th>Account</th><th>Flag</th>
    </tr></thead>
    <tbody id="expBody">
    </tbody>
    <tfoot><tr class="total-row"><td colspan="2">Showing Total</td><td id="expTotal">‚Äî</td><td colspan="4"></td></tr></tfoot>
  </table>
  </div>
</div>

<!-- UTILITIES TAB -->
<div id="tab-utilities" class="tab-content">
  <h2 style="color:#c9a84c;margin-bottom:16px">‚ö° Utility Accounts</h2>
  <div class="chart-card" style="margin-bottom:20px">
    <div class="chart-title">üìä Monthly Utility Costs by Property &amp; Type</div>
    <canvas id="utilityStackChart" style="min-height:320px;max-height:400px"></canvas>
  </div>

  <!-- Electric APS -->
  <div class="card">
    <div class="card-title" style="color:#444">‚ö° APS Electric</div>
    <div class="table-wrap">
    <table class="data-table">
      <thead><tr><th>Property</th><th>Jan 2026</th><th>Feb 2026</th><th>AutoPay</th><th>Notes</th></tr></thead>
      <tbody>
        <tr><td>Janice Way</td><td>$214.16</td><td>$289.08</td><td>~13th</td><td></td></tr>
        <tr><td>5th Dr</td><td>$54.90</td><td>$64.00</td><td>~14th</td><td></td></tr>
        <tr><td>Grandview</td><td>$59.25</td><td>$68.97</td><td>~15th</td><td></td></tr>
        <tr><td>38th Dr</td><td>$76.82</td><td>$96.49</td><td>~5th</td><td></td></tr>
      </tbody>
    </table>
    </div>
  </div>

  <!-- Electric SRP -->
  <div class="card">
    <div class="card-title" style="color:#444">‚ö° SRP Electric</div>
    <div class="table-wrap">
    <table class="data-table">
      <thead><tr><th>Property</th><th>Jan 2026</th><th>Feb 2026</th><th>Notes</th></tr></thead>
      <tbody>
        <tr class="warn-row"><td>25th St</td><td>$292.64 (2 payments)</td><td>TBD</td><td>‚ö†Ô∏è HIGH ‚Äî mini split scheduling needed before summer</td></tr>
        <tr class="warn-row"><td>Willow Ave (Personal)</td><td>$190.50</td><td>TBD</td><td>‚ö†Ô∏è Should move to personal checking</td></tr>
      </tbody>
    </table>
    </div>
  </div>

  <!-- Gas -->
  <div class="card">
    <div class="card-title" style="color:#444">üî• Southwest Gas</div>
    <div class="table-wrap">
    <table class="data-table">
      <thead><tr><th>Property</th><th>Jan 2026</th><th>Feb 2026</th></tr></thead>
      <tbody>
        <tr><td>Janice Way</td><td>$95.47</td><td>$98.72</td></tr>
        <tr><td>38th Dr</td><td>$89.90</td><td>$98.72</td></tr>
        <tr><td>25th St</td><td>$63.65</td><td>$63.65</td></tr>
      </tbody>
    </table>
    </div>
  </div>

  <!-- Internet/Phone Cox -->
  <div class="card">
    <div class="card-title" style="color:#444">üåê Cox Internet &amp; Phone</div>
    <div class="table-wrap">
    <table class="data-table">
      <thead><tr><th>Property</th><th>Monthly</th><th>AutoPay</th><th>Notes</th></tr></thead>
      <tbody>
        <tr class="warn-row"><td>Janice Way MAIN</td><td>$90.00</td><td>~1st</td><td>‚ö†Ô∏è Possible duplicate ‚Äî call Cox to verify</td></tr>
        <tr class="warn-row"><td>Janice Way DUPLICATE</td><td>$125.40</td><td>~10th</td><td>‚ö†Ô∏è DUPLICATE BILLING ‚Äî Call Cox to CANCEL this account immediately!</td></tr>
        <tr><td>38th Dr (bundle)</td><td>$16.04</td><td>~30th</td><td>Cancel when contract expires</td></tr>
        <tr><td>25th St</td><td>$80.00</td><td>~24th</td><td></td></tr>
        <tr><td>Grandview (internet)</td><td>$70.00</td><td>~18th</td><td></td></tr>
        <tr><td>Grandview (phone bundle)</td><td>$16.37</td><td>~31st</td><td>Cancel when contract expires</td></tr>
        <tr><td>5th Dr (internet)</td><td>$100.00</td><td>~5th</td><td>Highest rate ‚Äî negotiate down</td></tr>
        <tr><td>5th Dr (Cox Mobile)</td><td>$61.04</td><td>~5th</td><td>Personal cell, may be business deduction</td></tr>
      </tbody>
    </table>
    </div>
  </div>

  <!-- Water -->
  <div class="card">
    <div class="card-title" style="color:#38bdf8">üíß City of Phoenix Water (Feb 2026)</div>
    <div class="table-wrap">
    <table class="data-table">
      <thead><tr><th>Property</th><th>Amount</th><th>Due Date</th></tr></thead>
      <tbody>
        <tr><td>Grandview</td><td>$78.50</td><td>Feb 25</td></tr>
        <tr><td>38th Dr</td><td>$126.07</td><td>Mar 2</td></tr>
        <tr><td>Janice Way</td><td>$109.14</td><td>Feb 17</td></tr>
        <tr><td>5th Dr</td><td>$84.83</td><td>Mar 13</td></tr>
        <tr><td>25th St</td><td>$104.91</td><td>Mar 3</td></tr>
      </tbody>
    </table>
    </div>
  </div>

  <!-- Solar -->
  <div class="card">
    <div class="card-title" style="color:#22c55e">‚òÄÔ∏è Solar</div>
    <div class="table-wrap">
    <table class="data-table">
      <thead><tr><th>Property</th><th>Provider</th><th>Monthly</th></tr></thead>
      <tbody>
        <tr><td>5th Dr</td><td>Sunrun</td><td style="color:#22c55e;font-weight:700">$93.00</td></tr>
      </tbody>
    </table>
    </div>
  </div>

  <div class="card">
    <div class="card-title">üìä Estimated Monthly Utility Total by Property</div>
    <div class="table-wrap">
    <table class="data-table">
      <thead><tr><th>Property</th><th>Electric</th><th>Gas</th><th>Internet</th><th>Water</th><th>Solar</th><th>Total/mo</th></tr></thead>
      <tbody>
        <tr><td>Mesa Unit 32</td><td>‚Äî</td><td>‚Äî</td><td>‚Äî</td><td>‚Äî</td><td>‚Äî</td><td>‚Äî</td></tr>
        <tr><td>13th Ave</td><td>‚Äî</td><td>‚Äî</td><td>‚Äî</td><td>‚Äî</td><td>‚Äî</td><td>‚Äî</td></tr>
        <tr><td>5th Dr</td><td>$59</td><td>‚Äî</td><td>$161</td><td>$85</td><td>$93</td><td><strong>$398</strong></td></tr>
        <tr><td>38th Dr</td><td>$87</td><td>$94</td><td>$16</td><td>$126</td><td>‚Äî</td><td><strong>$323</strong></td></tr>
        <tr><td>Janice Way</td><td>$252</td><td>$97</td><td>$215</td><td>$109</td><td>‚Äî</td><td><strong style="color:#f87171">$673 ‚ö†Ô∏è</strong></td></tr>
        <tr><td>25th St</td><td>$293</td><td>$64</td><td>$80</td><td>$105</td><td>‚Äî</td><td><strong style="color:#fbbf24">$542</strong></td></tr>
        <tr><td>Grandview</td><td>$64</td><td>‚Äî</td><td>$86</td><td>$79</td><td>‚Äî</td><td><strong>$229</strong></td></tr>
      </tbody>
    </table>
    </div>
  </div>
</div>

<!-- VENDORS TAB -->
<div id="tab-vendors" class="tab-content">
  <h2 style="color:#c9a84c;margin-bottom:16px">ü§ù Recurring Vendors</h2>
  <div class="table-wrap">
  <table class="data-table" id="vendorTable">
    <thead><tr>
      <th>Vendor</th><th>Category</th><th>Property</th><th>Jan 2026</th><th>Feb 2026</th><th>Txns</th><th>Notes</th>
    </tr></thead>
    <tbody>
      <tr><td><strong>ShellPoint Mortgage</strong></td><td><span class="badge badge-gray">Mortgage</span></td><td>38th Dr + 25th St</td><td>$5,015.19</td><td>$5,015.19</td><td>2</td><td></td></tr>
      <tr><td><strong>Mountain America CU</strong></td><td><span class="badge badge-gray">Mortgage</span></td><td>13th Ave + Janice Way</td><td>$5,846.40</td><td>$5,846.40</td><td>2</td><td></td></tr>
      <tr><td><strong>Capital Fund 1</strong></td><td><span class="badge badge-gray">Mortgage</span></td><td>Grandview</td><td>$3,763.00</td><td>$3,763.00</td><td>1</td><td>Refinancing in progress</td></tr>
      <tr><td><strong>PennyMac</strong></td><td><span class="badge badge-gray">Mortgage</span></td><td>Mesa + 5th Dr</td><td>$3,544.26</td><td>$3,544.26</td><td>2</td><td></td></tr>
      <tr><td><strong>Solace Cleaning</strong></td><td><span class="badge badge-blue">Cleaning</span></td><td>Multiple</td><td>$850</td><td>$850</td><td>4+</td><td>Regular cleaning service</td></tr>
      <tr><td><strong>Juan Electric</strong></td><td><span class="badge badge-blue">Repairs &amp; Labor</span></td><td>Grandview, 25th St, 38th Dr</td><td>$1,540</td><td>‚Äî</td><td>4</td><td>Jan: Grandview setup + 25th St + 38th Dr</td></tr>
      <tr><td><strong>Jonatan Landscaping</strong></td><td><span class="badge badge-blue">Landscaping</span></td><td>Grandview, Janice Way</td><td>$1,329.86</td><td>‚Äî</td><td>2</td><td>Patios, landscaping, irrigation</td></tr>
      <tr><td><strong>Redbox+ Dumpsters</strong></td><td><span class="badge badge-blue">Landscaping</span></td><td>Multiple</td><td>‚Äî</td><td>‚Äî</td><td>‚Äî</td><td>Junk removal</td></tr>
      <tr><td><strong>Home Depot</strong></td><td><span class="badge badge-amber">Materials</span></td><td>‚ö†Ô∏è Unassigned</td><td>‚Äî</td><td>‚Äî</td><td>82+</td><td>Pull HD Pro PO# list to assign properties</td></tr>
      <tr><td><strong>Amazon</strong></td><td><span class="badge badge-amber">Materials</span></td><td>‚ö†Ô∏è Unassigned (82 txns)</td><td>‚Äî</td><td>‚Äî</td><td>82</td><td>Cross-ref order history for property assignment</td></tr>
      <tr><td><strong>Cox Communications</strong></td><td><span class="badge badge-blue">Internet</span></td><td>Multiple</td><td>$558.85</td><td>$558.85</td><td>8</td><td>‚ö†Ô∏è Janice Way duplicate $125.40 ‚Äî cancel!</td></tr>
      <tr><td><strong>APS Electric</strong></td><td><span class="badge badge-blue">Utilities</span></td><td>Multiple</td><td>$405.13</td><td>$518.54</td><td>4</td><td></td></tr>
      <tr><td><strong>Southwest Gas</strong></td><td><span class="badge badge-blue">Utilities</span></td><td>Multiple</td><td>$249.02</td><td>$261.09</td><td>3</td><td></td></tr>
      <tr><td><strong>SRP Electric</strong></td><td><span class="badge badge-blue">Utilities</span></td><td>25th St + Personal</td><td>$483.14</td><td>TBD</td><td>3</td><td>‚ö†Ô∏è 25th St high; Willow Ave should be personal</td></tr>
      <tr><td><strong>TechniArt</strong></td><td><span class="badge badge-amber">Software &amp; Tech</span></td><td>‚ö†Ô∏è Verify</td><td>$126.36</td><td>‚Äî</td><td>4</td><td>‚ö†Ô∏è 4 charges ‚Äî only 1-2 thermostats ordered</td></tr>
      <tr><td><strong>Gabriel Carpet</strong></td><td><span class="badge badge-blue">Repairs &amp; Labor</span></td><td>Janice Way</td><td>$320.90</td><td>‚Äî</td><td>1</td><td></td></tr>
      <tr><td><strong>Terry CO-Living</strong></td><td><span class="badge badge-blue">Marketing</span></td><td>Grandview</td><td>$105.00</td><td>‚Äî</td><td>1</td><td>Flyers</td></tr>
      <tr><td><strong>Sunrun Solar</strong></td><td><span class="badge badge-green">Solar</span></td><td>5th Dr</td><td>$93.00</td><td>$93.00</td><td>1</td><td></td></tr>
    </tbody>
  </table>
  </div>
</div>

<!-- NOTE: properties tab defined earlier in file -->
<div id="tab-properties" class="tab-content">
  <h2>
  <div class="note-banner">‚ÑπÔ∏è Feb 2026 checking statement not yet received. Expense totals reflect Jan 2026 known expenses. Income totals include available Jan + Feb data.</div>

  <!-- Mesa Unit 32 -->
  <div class="prop-card green-card">
    <div style="display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:8px">
      <div>
        <div class="prop-name">Mesa Unit 32</div>
        <div class="prop-address">125 N 22nd Pl #32, Mesa AZ ¬∑ PennyMac ¬∑ 4.5% ¬∑ $1,124.78/mo</div>
      </div>
      <span class="badge badge-green">Long-Term Tenant</span>
    </div>
    <div class="prop-grid" style="margin-top:16px">
      <div class="prop-stat"><div class="prop-stat-label">Mortgage</div><div class="prop-stat-value expense">$1,124.78</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Rent Income</div><div class="prop-stat-value income">$2,113.95</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Tenant</div><div class="prop-stat-value" style="font-size:14px">Ricardo Vizcarra</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Est. Monthly NOI</div><div class="prop-stat-value noi-pos">+$989</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Rate / Lender</div><div class="prop-stat-value" style="font-size:13px">4.5% ¬∑ PennyMac</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Utilities</div><div class="prop-stat-value" style="font-size:14px">Tenant pays</div></div>
    </div>
  </div>

  <!-- 13th Ave -->
  <div class="prop-card green-card">
    <div style="display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:8px">
      <div>
        <div class="prop-name">13th Ave</div>
        <div class="prop-address">17442 N 13th Ave, Phoenix AZ ¬∑ Mountain America ¬∑ 7.375% ¬∑ $2,418.35/mo</div>
      </div>
      <span class="badge badge-green">Long-Term Tenant</span>
    </div>
    <div class="prop-grid" style="margin-top:16px">
      <div class="prop-stat"><div class="prop-stat-label">Mortgage</div><div class="prop-stat-value expense">$2,418.35</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Rent Income</div><div class="prop-stat-value income">$2,480.00</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Tenant</div><div class="prop-stat-value" style="font-size:14px">Ian Decker</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Est. Monthly NOI</div><div class="prop-stat-value noi-pos">+$62</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Rate / Lender</div><div class="prop-stat-value" style="font-size:13px">7.375% ¬∑ Mtn America</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Refi Opportunity</div><div class="prop-stat-value" style="font-size:12px;color:#444">Monitor rates</div></div>
    </div>
  </div>

  <!-- 5th Dr -->
  <div class="prop-card green-card">
    <div style="display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:8px">
      <div>
        <div class="prop-name">5th Dr (PadSplit)</div>
        <div class="prop-address">19817 N 5th Dr, Phoenix AZ ¬∑ PennyMac ¬∑ 6.375% ¬∑ $2,419.48/mo</div>
      </div>
      <span class="badge badge-gold">PadSplit</span>
    </div>
    <div class="prop-grid" style="margin-top:16px">
      <div class="prop-stat"><div class="prop-stat-label">Mortgage</div><div class="prop-stat-value expense">$2,419.48</div></div>
      <div class="prop-stat"><div class="prop-stat-label">PadSplit Jan</div><div class="prop-stat-value income">$4,800</div></div>
      <div class="prop-stat"><div class="prop-stat-label">PadSplit Feb est.</div><div class="prop-stat-value income">$4,742</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Electric (APS)</div><div class="prop-stat-value expense">$54‚Äì$64</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Internet (Cox)</div><div class="prop-stat-value expense">$100/mo</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Solar (Sunrun)</div><div class="prop-stat-value expense">$93/mo</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Water</div><div class="prop-stat-value expense">$85/mo</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Est. Monthly NOI</div><div class="prop-stat-value noi-pos">+$2,025</div></div>
    </div>
  </div>

  <!-- 38th Dr -->
  <div class="prop-card green-card">
    <div style="display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:8px">
      <div>
        <div class="prop-name">38th Dr (PadSplit + Selyna)</div>
        <div class="prop-address">14802 N 38th Dr, Phoenix AZ ¬∑ ShellPoint ¬∑ 7.125% ¬∑ $2,594.95/mo</div>
      </div>
      <span class="badge badge-gold">PadSplit + Direct</span>
    </div>
    <div class="prop-grid" style="margin-top:16px">
      <div class="prop-stat"><div class="prop-stat-label">Mortgage</div><div class="prop-stat-value expense">$2,594.95</div></div>
      <div class="prop-stat"><div class="prop-stat-label">PadSplit Jan</div><div class="prop-stat-value income">$3,628</div></div>
      <div class="prop-stat"><div class="prop-stat-label">PadSplit Feb est.</div><div class="prop-stat-value income">$3,177</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Selyna (Rm 4) Jan</div><div class="prop-stat-value income">$1,125</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Selyna (Rm 4) Feb ‚ö†Ô∏è</div><div class="prop-stat-value" style="color:#444">$515 (partial)</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Electric (APS)</div><div class="prop-stat-value expense">$77‚Äì$96</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Gas (SW Gas)</div><div class="prop-stat-value expense">$90‚Äì$99</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Water</div><div class="prop-stat-value expense">$126/mo</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Est. Monthly NOI</div><div class="prop-stat-value noi-pos">+$1,800+</div></div>
    </div>
  </div>

  <!-- Janice Way -->
  <div class="prop-card amber-card">
    <div style="display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:8px">
      <div>
        <div class="prop-name">Janice Way (PadSplit + Airbnb + RP)</div>
        <div class="prop-address">2302 E Janice Way, Phoenix AZ ¬∑ Mountain America ¬∑ 6.75% ¬∑ $3,428.05/mo</div>
      </div>
      <span class="badge badge-amber">‚ö†Ô∏è Duplicate Cox Billing</span>
    </div>
    <div class="prop-grid" style="margin-top:16px">
      <div class="prop-stat"><div class="prop-stat-label">Mortgage</div><div class="prop-stat-value expense">$3,428.05</div></div>
      <div class="prop-stat"><div class="prop-stat-label">PadSplit Jan</div><div class="prop-stat-value income">$2,683</div></div>
      <div class="prop-stat"><div class="prop-stat-label">PadSplit Feb est.</div><div class="prop-stat-value income">$2,259</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Airbnb Feb (2 rooms)</div><div class="prop-stat-value income">$2,739</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Rent Perfect (2 rooms)</div><div class="prop-stat-value income">$1,944</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Electric (APS)</div><div class="prop-stat-value expense">$214‚Äì$289</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Gas (SW Gas)</div><div class="prop-stat-value expense">$95‚Äì$99</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Internet (Cox √ó2)</div><div class="prop-stat-value expense" style="color:#444">$215 ‚ö†Ô∏è Dup!</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Water</div><div class="prop-stat-value expense">$109/mo</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Est. Monthly NOI</div><div class="prop-stat-value noi-pos">+$2,900+</div></div>
    </div>
  </div>

  <!-- 25th St -->
  <div class="prop-card amber-card">
    <div style="display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:8px">
      <div>
        <div class="prop-name">25th St (PadSplit + Airbnb + RP)</div>
        <div class="prop-address">8229 S 25th St, Phoenix AZ ¬∑ ShellPoint ¬∑ 7.125% ¬∑ $2,420.24/mo</div>
      </div>
      <span class="badge badge-amber">‚ö†Ô∏è High Electric Bill</span>
    </div>
    <div class="prop-grid" style="margin-top:16px">
      <div class="prop-stat"><div class="prop-stat-label">Mortgage</div><div class="prop-stat-value expense">$2,420.24</div></div>
      <div class="prop-stat"><div class="prop-stat-label">PadSplit Jan</div><div class="prop-stat-value income">$4,249</div></div>
      <div class="prop-stat"><div class="prop-stat-label">PadSplit Feb est.</div><div class="prop-stat-value income">$3,530</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Airbnb (Rm 7)</div><div class="prop-stat-value income">$1,236</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Isaiah Rm 6 ¬∑ Lilliana pays RP</div><div class="prop-stat-value income">$904</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Electric (SRP) ‚ö†Ô∏è</div><div class="prop-stat-value expense" style="color:#444">$293/mo</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Gas (SW Gas)</div><div class="prop-stat-value expense">$64/mo</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Internet (Cox)</div><div class="prop-stat-value expense">$80/mo</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Water</div><div class="prop-stat-value expense">$105/mo</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Est. Monthly NOI</div><div class="prop-stat-value noi-pos">+$2,200+</div></div>
    </div>
  </div>

  <!-- Grandview -->
  <div class="prop-card amber-card">
    <div style="display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:8px">
      <div>
        <div class="prop-name">Grandview Rd (PadSplit + Airbnb + Direct)</div>
        <div class="prop-address">4029 W Grandview Rd, Phoenix AZ ¬∑ Capital Fund 1 ¬∑ Refinancing 10.5%‚Üí6.75%</div>
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <span class="badge badge-blue">üÜï New Property Jan 2026</span>
        <span class="badge badge-amber">üîÑ Refinancing in Progress</span>
      </div>
    </div>
    <div class="note-banner" style="margin-top:12px">üîÑ <strong>Refinancing in Progress:</strong> New loan $535,500 at 6.75% ¬∑ P&amp;I $3,473.24 + $339 T/I/A = $3,812 total/mo ¬∑ Significant improvement from current 10.5% I/O</div>
    <div class="prop-grid" style="margin-top:12px">
      <div class="prop-stat"><div class="prop-stat-label">Current Mortgage</div><div class="prop-stat-value expense">$3,763/mo</div></div>
      <div class="prop-stat"><div class="prop-stat-label">New Payment (post-refi)</div><div class="prop-stat-value" style="color:#444">$3,812/mo</div></div>
      <div class="prop-stat"><div class="prop-stat-label">PadSplit Jan (ramping)</div><div class="prop-stat-value income">$366</div></div>
      <div class="prop-stat"><div class="prop-stat-label">PadSplit Feb est.</div><div class="prop-stat-value income">$2,529</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Airbnb (Rm 8-9)</div><div class="prop-stat-value income">$2,742</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Jarrett (Rm 5)</div><div class="prop-stat-value income">$1,200/mo</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Omar (Rm 1)</div><div class="prop-stat-value income">$1,800</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Electric (APS)</div><div class="prop-stat-value expense">$59‚Äì$69</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Internet (Cox)</div><div class="prop-stat-value expense">$70/mo</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Water</div><div class="prop-stat-value expense">$79/mo</div></div>
      <div class="prop-stat"><div class="prop-stat-label">Est. Monthly NOI</div><div class="prop-stat-value" style="color:#444">Ramping Up</div></div>
    </div>
  </div>
</div>



<!-- NEEDS REVIEW TAB -->
<div id="tab-review" class="tab-content">
  <div style="display:flex;align-items:center;gap:12px;margin-bottom:20px;flex-wrap:wrap">
    <h2 style="color:#c9a84c">üî¥ Needs Review</h2>
    <span class="pending-counter" id="pendingCount">Pending Changes: 0</span>
    <button class="copy-btn" onclick="copyChangesSummary()">üìã Copy Changes Summary</button>
  </div>
  <div class="note-banner" style="border-color:#444">üî¥ Total unresolved value: <strong id="unresolvedTotal">calculating...</strong> ¬∑ Resolve items below and click "Copy Changes Summary" to send updates for processing.</div>

  <div class="review-group">
    <div class="review-group-title">üî¥ Needs Property Assignment ‚Äî Unassigned Expenses</div>
    <div class="review-row" id="rr-hd1" data-amount="482.35">
      <div class="review-row-header">
        <span class="review-date">Jan 2026</span>
        <span class="review-desc">Home Depot ‚Äî Multiple charges</span>
        <span class="review-amount">$482.35</span>
        <span class="badge badge-red" id="status-hd1">Needs Review</span>
      </div>
      <div class="review-why">We couldn't figure out which property these Home Depot charges belong to ‚Äî please pull your HD Pro account PO# list and assign them. Each PO# = a property address.</div>
      <div class="review-edit-row">
        <select class="review-select" id="cat-hd1"><option>Materials &amp; Supplies</option><option>Repairs &amp; Labor</option><option>Furnishings</option></select>
        <select class="review-select" id="prop-hd1"><option value="">‚Äî Assign Property ‚Äî</option><option>Mesa Unit 32</option><option>13th Ave</option><option>5th Dr</option><option>38th Dr</option><option>Janice Way</option><option>Grandview</option><option>25th St</option><option>Personal</option><option>Multiple (see notes)</option></select>
        <input class="review-input" id="notes-hd1" placeholder="Notes...">
        <button class="review-btn" onclick="editRow('hd1')">‚úèÔ∏è Save Edit</button>
        <button class="review-btn resolve" onclick="resolveRow('hd1')">‚úÖ Mark Resolved</button>
      </div>
    </div>

    <div class="review-row" id="rr-zelle1" data-amount="0">
      <div class="review-row-header">
        <span class="review-date">Feb 2026</span>
        <span class="review-desc">Zelle: Omar Hamad $1,800 ‚Äî Grandview Rm 1</span>
        <span class="review-amount" style="color:#4ade80">+$1,800.00</span>
        <span class="badge badge-blue" id="status-zelle1">Updated</span>
      </div>
      <div class="review-why">Omar Hamad paid $1,800 via Zelle. Confirmed: this is rent for Grandview Room 1 through 3/28/2026. Please verify this is correctly categorized as rental income.</div>
      <div class="review-edit-row">
        <select class="review-select" id="cat-zelle1"><option>Rent Income</option></select>
        <select class="review-select" id="prop-zelle1"><option>Grandview</option></select>
        <input class="review-input" id="notes-zelle1" placeholder="Notes..." value="Omar Hamad - Grandview Rm 1, through 3/28/2026">
        <button class="review-btn" onclick="editRow('zelle1')">‚úèÔ∏è Save Edit</button>
        <button class="review-btn resolve" onclick="resolveRow('zelle1')">‚úÖ Mark Resolved</button>
      </div>
    </div>
  </div>

  <div class="review-group">
    <div class="review-group-title">‚ö†Ô∏è Verify Amount / Unusual Transactions</div>

    <div class="review-row" id="rr-tech1" data-amount="126.36">
      <div class="review-row-header">
        <span class="review-date">Jan 2026</span>
        <span class="review-desc">TechniArt √ó 4 charges ($31.59 √ó 4)</span>
        <span class="review-amount">$126.36</span>
        <span class="badge badge-red" id="status-tech1">Needs Review</span>
      </div>
      <div class="review-why">4 TechniArt charges found ($31.59 √ó 4 = $126.36) but you said you only ordered 1‚Äì2 thermostats. Are these a subscription, duplicates, or separate units for different rooms? Review and cancel if it's an unwanted subscription.</div>
      <div class="review-edit-row">
        <select class="review-select" id="cat-tech1"><option>Software &amp; Tech</option><option>Materials &amp; Supplies</option></select>
        <select class="review-select" id="prop-tech1"><option value="">‚Äî Assign Property ‚Äî</option><option>Mesa Unit 32</option><option>13th Ave</option><option>5th Dr</option><option>38th Dr</option><option>Janice Way</option><option>Grandview</option><option>25th St</option><option>Personal</option></select>
        <input class="review-input" id="notes-tech1" placeholder="Subscription? Duplicates? Which property?">
        <button class="review-btn" onclick="editRow('tech1')">‚úèÔ∏è Save Edit</button>
        <button class="review-btn resolve" onclick="resolveRow('tech1')">‚úÖ Mark Resolved</button>
      </div>
    </div>

    <div class="review-row" id="rr-sel1" data-amount="52.50">
      <div class="review-row-header">
        <span class="review-date">Feb 6, 2026</span>
        <span class="review-desc">Selyna Venmo ‚Äî 38th Dr Rm 4 (unusually low)</span>
        <span class="review-amount" style="color:#444">$52.50</span>
        <span class="badge badge-red" id="status-sel1">Needs Review</span>
      </div>
      <div class="review-why">Selyna's February 6th payment of $52.50 is much less than her usual $462.50 semi-monthly base amount. Is this a partial payment, a late fee only, or did she pay the rest a different way this period?</div>
      <div class="review-edit-row">
        <select class="review-select" id="cat-sel1"><option>Rent Income</option></select>
        <select class="review-select" id="prop-sel1"><option>38th Dr</option></select>
        <input class="review-input" id="notes-sel1" placeholder="Partial payment? Late fee only? Other explanation?">
        <button class="review-btn" onclick="editRow('sel1')">‚úèÔ∏è Save Edit</button>
        <button class="review-btn resolve" onclick="resolveRow('sel1')">‚úÖ Mark Resolved</button>
      </div>
    </div>

    <div class="review-row" id="rr-ml1" data-amount="206">
      <div class="review-row-header">
        <span class="review-date">Jan 2026</span>
        <span class="review-desc">Cash Advance ‚Äî $206</span>
        <span class="review-amount">$206.00</span>
        <span class="badge badge-red" id="status-ml1">Needs Review</span>
      </div>
      <div class="review-why">A $206 cash advance appeared on the credit card. Cash advances carry high fees and interest from day one. What was this for, and which property/category should it be assigned to?</div>
      <div class="review-edit-row">
        <select class="review-select" id="cat-ml1"><option>Bank Fees &amp; Interest</option><option>Repairs &amp; Labor</option><option>Personal</option><option>Business General</option></select>
        <select class="review-select" id="prop-ml1"><option value="">‚Äî Assign Property ‚Äî</option><option>Mesa Unit 32</option><option>13th Ave</option><option>5th Dr</option><option>38th Dr</option><option>Janice Way</option><option>Grandview</option><option>25th St</option><option>Personal</option></select>
        <input class="review-input" id="notes-ml1" placeholder="What was this advance for?">
        <button class="review-btn" onclick="editRow('ml1')">‚úèÔ∏è Save Edit</button>
        <button class="review-btn resolve" onclick="resolveRow('ml1')">‚úÖ Mark Resolved</button>
      </div>
    </div>

    <div class="review-row" id="rr-cox1" data-amount="125.40">
      <div class="review-row-header">
        <span class="review-date">Monthly</span>
        <span class="review-desc">Cox Internet ‚Äî Janice Way 701 Account (Possible Duplicate)</span>
        <span class="review-amount">$125.40</span>
        <span class="badge badge-red" id="status-cox1">Needs Review</span>
      </div>
      <div class="review-why">This Cox account may be a duplicate billing at Janice Way ‚Äî you're paying for two internet accounts at the same address ($90 + $125.40 = $215.40/mo). Call Cox to confirm which account is active and cancel the duplicate. Save ~$125/mo = $1,500/yr.</div>
      <div class="review-edit-row">
        <select class="review-select" id="cat-cox1"><option>Utilities - Internet</option></select>
        <select class="review-select" id="prop-cox1"><option>Janice Way</option></select>
        <input class="review-input" id="notes-cox1" placeholder="Called Cox? Cancelled? Notes...">
        <button class="review-btn" onclick="editRow('cox1')">‚úèÔ∏è Save Edit</button>
        <button class="review-btn resolve" onclick="resolveRow('cox1')">‚úÖ Mark Resolved</button>
      </div>
    </div>

    <div class="review-row" id="rr-srp1" data-amount="190.50">
      <div class="review-row-header">
        <span class="review-date">Jan 2026</span>
        <span class="review-desc">SRP Electric ‚Äî Willow Ave (Primary Residence on Business Account)</span>
        <span class="review-amount">$190.50</span>
        <span class="badge badge-red" id="status-srp1">Needs Review</span>
      </div>
      <div class="review-why">This SRP payment is for Willow Ave, your primary residence ‚Äî not a rental property. It's being paid from the business checking account. Call SRP and change the payment account to your personal checking to keep business and personal expenses separate.</div>
      <div class="review-edit-row">
        <select class="review-select" id="cat-srp1"><option>Personal</option><option>Utilities - Electric</option></select>
        <select class="review-select" id="prop-srp1"><option>Personal</option></select>
        <input class="review-input" id="notes-srp1" placeholder="Called SRP to switch to personal checking?">
        <button class="review-btn" onclick="editRow('srp1')">‚úèÔ∏è Save Edit</button>
        <button class="review-btn resolve" onclick="resolveRow('srp1')">‚úÖ Mark Resolved</button>
      </div>
    </div>
  </div>

  <div class="review-group">
    <div class="review-group-title collapsible-toggle" onclick="toggleCollapsible('amazon-group')">
      üì¶ Amazon Orders ‚Äî Need Property Assignment (82 transactions) ‚Äî Click to Expand ‚ñº
    </div>
    <div id="amazon-group" class="collapsible-content">
      <div class="note-banner">These 82 Amazon transactions need to be matched to Amazon order history to determine which property each purchase was for. Go to Amazon Business ‚Üí Orders ‚Üí Export CSV for Jan‚ÄìFeb 2026 and upload to Tasklet for automatic assignment.</div>
      <div class="review-row" id="rr-amz1" data-amount="1640">
        <div class="review-row-header">
          <span class="review-date">Jan‚ÄìFeb 2026</span>
          <span class="review-desc">Amazon ‚Äî 82 transactions (estimated total ~$1,640+)</span>
          <span class="review-amount">~$1,640+</span>
          <span class="badge badge-red" id="status-amz1">Needs Review</span>
        </div>
        <div class="review-why">82 Amazon purchases across Jan‚ÄìFeb 2026 need property assignment. Cross-reference your Amazon order history ‚Äî item descriptions usually make it clear which property they're for (bathroom fixtures, mattresses, cleaning supplies, etc.).</div>
        <div class="review-edit-row">
          <input class="review-input" id="notes-amz1" placeholder="Upload Amazon CSV to Tasklet for auto-assignment..." style="width:350px">
          <button class="review-btn resolve" onclick="resolveRow('amz1')">‚úÖ Mark All Resolved (after upload)</button>
        </div>
      </div>
    </div>
  </div>

  <div class="review-group">
    <div class="review-group-title collapsible-toggle" onclick="toggleCollapsible('resolved-group')">
      ‚úÖ Already Resolved ‚Äî Click to Expand ‚ñº
    </div>
    <div id="resolved-group" class="collapsible-content">
      <div id="resolvedContainer" style="color:#8899aa;font-size:13px;padding:12px">No items resolved yet. Use ‚úÖ buttons above to mark items resolved.</div>
    </div>
  </div>
</div>

<!-- OPTIMIZE TAB -->
<div id="tab-optimize" class="tab-content">
  <h2 style="color:#c9a84c;margin-bottom:20px">üí∞ Optimize ‚Äî Savings &amp; Action Items</h2>
  <h3 style="color:#f87171;margin-bottom:12px">üî¥ URGENT</h3>

  <div class="opt-card urgent">
    <div class="opt-icon">üåê</div>
    <div class="opt-body">
      <div class="opt-title">Janice Way ‚Äî Double Cox Billing</div>
      <div class="opt-desc">Two Cox internet accounts at the same address: $90/mo (main) + $125.40/mo (701 account) = $215.40/mo total. You are paying for two internet connections at one property.</div>
      <div class="opt-savings">üí∞ Save ~$125/mo = $1,500/yr ‚Äî Call Cox to cancel the 701 account NOW</div>
      <div class="opt-action">üìû Action: Call Cox Business, identify the duplicate 701 account at 2302 E Janice Way, confirm main service working, cancel duplicate</div>
    </div>
    <span class="badge badge-red">URGENT</span>
  </div>

  <div class="opt-card urgent">
    <div class="opt-icon">‚ö°</div>
    <div class="opt-body">
      <div class="opt-title">25th St Electric Bill Too High ‚Äî Mini Split Scheduling Before Summer</div>
      <div class="opt-desc">SRP electric at 25th St is significantly higher than comparable PadSplit properties. Each room has its own mini split. Without schedules, residents leave them running on low temps all day. Set auto-off schedules NOW before summer heat arrives and bills double.</div>
      <div style="background:#0d1b2e;border-radius:8px;padding:12px;margin:10px 0;font-size:13px;color:#444;line-height:1.8">
        <strong style="color:#c9a84c">üìÖ Recommended Schedule:</strong><br>
        ‚Ä¢ <strong>Weekdays 9am‚Äì4pm:</strong> Auto-off (most residents are out)<br>
        ‚Ä¢ <strong>Nights:</strong> Set to 74¬∞F minimum, not 68¬∞F ‚Äî saves ~30%<br>
        ‚Ä¢ <strong>Vacant rooms:</strong> Turn off or set to 85¬∞F<br>
        ‚Ä¢ <strong>Summer prep (before June):</strong> Replace filters, check refrigerant
      </div>
      <div class="opt-savings">üí∞ Save $40‚Äì80/mo = $480‚Äì960/yr</div>
      <div class="opt-action">üì± Action: Message all 25th St residents this week with new schedule policy</div>
    </div>
    <span class="badge badge-red">URGENT</span>
  </div>

  <div class="opt-card urgent">
    <div class="opt-icon">üè†</div>
    <div class="opt-body">
      <div class="opt-title">SRP Willow Ave ‚Äî Move to Personal Checking</div>
      <div class="opt-desc">The SRP electric bill for Willow Ave (primary residence) is being paid from the business checking account. This creates bookkeeping issues and tax complications.</div>
      <div class="opt-savings">‚úÖ Fix bookkeeping ¬∑ Avoid tax issues</div>
      <div class="opt-action">üìû Action: Call SRP, update payment account for Willow Ave to personal checking</div>
    </div>
    <span class="badge badge-amber">Action Needed</span>
  </div>

  <h3 style="color:#4ade80;margin:24px 0 12px">üí∞ SAVINGS OPPORTUNITIES</h3>

  <div class="opt-card savings">
    <div class="opt-icon">üìû</div>
    <div class="opt-body">
      <div class="opt-title">Cox Contract Expiration ‚Äî Multi-Property Renegotiation</div>
      <div class="opt-desc">Check expiry on all Cox accounts. You have 5+ Cox accounts ‚Äî that's leverage for a multi-property bundle discount. Most ISPs offer 20‚Äì30% off to retain business customers with multiple accounts.</div>
      <div class="opt-savings">üí∞ Potential 20‚Äì30% off all accounts = $100‚Äì150/mo savings</div>
    </div>
    <span class="badge badge-green">Savings</span>
  </div>

  <div class="opt-card savings">
    <div class="opt-icon">üåê</div>
    <div class="opt-body">
      <div class="opt-title">5th Dr Cox Internet $100/mo ‚Äî Negotiate Down</div>
      <div class="opt-desc">5th Dr Cox is $100/mo, highest of all properties. Others pay $70‚Äì80/mo. Call to negotiate.</div>
      <div class="opt-savings">üí∞ Potential savings $20‚Äì30/mo = $240‚Äì360/yr</div>
    </div>
    <span class="badge badge-green">Savings</span>
  </div>

  <div class="opt-card savings">
    <div class="opt-icon">üìµ</div>
    <div class="opt-body">
      <div class="opt-title">Grandview Phone Bundle $16.37/mo ‚Äî Cancel When Contract Expires</div>
      <div class="opt-desc">Cox phone bundle at Grandview ‚Äî cancel when contract expires if landline unused.</div>
      <div class="opt-savings">üí∞ Save $196/yr</div>
    </div>
    <span class="badge badge-green">Savings</span>
  </div>

  <div class="opt-card savings">
    <div class="opt-icon">üìµ</div>
    <div class="opt-body">
      <div class="opt-title">38th Dr Phone Bundle $16.04/mo ‚Äî Cancel When Contract Expires</div>
      <div class="opt-desc">Cox phone bundle at 38th Dr ‚Äî cancel when contract expires if landline unused.</div>
      <div class="opt-savings">üí∞ Save $193/yr</div>
    </div>
    <span class="badge badge-green">Savings</span>
  </div>

  <div class="opt-card savings">
    <div class="opt-icon">üì±</div>
    <div class="opt-body">
      <div class="opt-title">Cox Mobile $61.04/mo ‚Äî Classify as Business Phone (Tax Deduction)</div>
      <div class="opt-desc">Cox Mobile cell phone ($61.04/mo billed to 5th Dr) ‚Äî if used for property management, may qualify as business phone expense deduction.</div>
      <div class="opt-savings">üí∞ ~$732/yr potential deduction ‚Äî Ask accountant to classify as Phone category</div>
    </div>
    <span class="badge badge-green">Savings</span>
  </div>

  <div class="opt-card savings">
    <div class="opt-icon">üè¶</div>
    <div class="opt-body">
      <div class="opt-title">Grandview Refinancing ‚Äî Approved! üéâ</div>
      <div class="opt-desc">Refinancing approved! Moving from 10.5% interest-only to 6.75% P&amp;I. New: $535,500 at 6.75% ‚Äî P&amp;I $3,473.24 + $339 T/I/A = $3,812/mo total. Now building equity. Ensure smooth closing.</div>
      <div class="opt-savings">‚úÖ Lower rate ¬∑ Building equity ¬∑ Improved cash position</div>
    </div>
    <span class="badge badge-blue">In Progress</span>
  </div>

  <div class="opt-card savings">
    <div class="opt-icon">üìä</div>
    <div class="opt-body">
      <div class="opt-title">13th Ave at 7.375% ‚Äî Monitor for Refinance Opportunity</div>
      <div class="opt-desc">13th Ave has a 7.375% Mountain America loan. Monitor rates ‚Äî when they drop 0.5‚Äì1%, refinancing could save $100‚Äì200/mo.</div>
      <div class="opt-savings">üí∞ Potential $100‚Äì200/mo when rates drop</div>
    </div>
    <span class="badge badge-gray">Monitor</span>
  </div>

  <h3 style="color:#60a5fa;margin:24px 0 12px">üìã MONTHLY WORKFLOW REMINDERS</h3>

  <div class="opt-card reminder">
    <div class="opt-icon">üè™</div>
    <div class="opt-body">
      <div class="opt-title">Pull Home Depot PO# List Monthly</div>
      <div class="opt-desc">HD Pro account ‚Üí Order History ‚Üí Export with PO numbers. PO# = property address. Upload to Tasklet for automatic property assignment of all HD charges.</div>
    </div>
    <span class="badge badge-blue">Monthly</span>
  </div>

  <div class="opt-card reminder">
    <div class="opt-icon">üí∏</div>
    <div class="opt-body">
      <div class="opt-title">Pull Zelle Transaction Report Monthly</div>
      <div class="opt-desc">Chase Online ‚Üí Zelle ‚Üí Transaction History ‚Üí Export with memo/notes. Memo = property address. Upload to Tasklet for auto-assignment.</div>
    </div>
    <span class="badge badge-blue">Monthly</span>
  </div>

  <div class="opt-card reminder">
    <div class="opt-icon">üè†</div>
    <div class="opt-body">
      <div class="opt-title">Pull PadSplit CSV Monthly</div>
      <div class="opt-desc">padsplit.com ‚Üí Dashboard ‚Üí Earnings ‚Üí select month ‚Üí Export CSV ‚Üí extract zip ‚Üí upload "collected" file to Tasklet.</div>
    </div>
    <span class="badge badge-blue">Monthly</span>
  </div>

  <div class="opt-card reminder">
    <div class="opt-icon">‚úàÔ∏è</div>
    <div class="opt-body">
      <div class="opt-title">Pull Airbnb Transaction History Monthly</div>
      <div class="opt-desc">airbnb.com ‚Üí Earnings ‚Üí Transaction History ‚Üí filter by month ‚Üí Export CSV ‚Üí upload to Tasklet.</div>
    </div>
    <span class="badge badge-blue">Monthly</span>
  </div>

  <div class="opt-card reminder">
    <div class="opt-icon">üìö</div>
    <div class="opt-body">
      <div class="opt-title">Import Historical Data (2023‚Äì2025) ‚Äî One Time</div>
      <div class="opt-desc">Ask accountant to export QuickBooks data: date, amount, vendor, category, property. Enables year-over-year analysis and teaches the system your accountant's exact category names.</div>
    </div>
    <span class="badge badge-gray">One-Time</span>
  </div>

  <h3 style="color:#fbbf24;margin:24px 0 12px">‚ö†Ô∏è NEEDS INVESTIGATION</h3>

  <div class="opt-card warn">
    <div class="opt-icon">üå°Ô∏è</div>
    <div class="opt-body">
      <div class="opt-title">TechniArt ‚Äî 4 Charges ($31.59 √ó 4 = $126.36)</div>
      <div class="opt-desc">You were charged $31.59 by TechniArt four times but only ordered 1‚Äì2 thermostats. Possible subscription, duplicate billing, or 4 units for different rooms.</div>
      <div class="opt-action">üìã Action: Check TechniArt account. Cancel subscription if not needed.</div>
    </div>
    <span class="badge badge-amber">Investigate</span>
  </div>

  <div class="opt-card warn">
    <div class="opt-icon">üíµ</div>
    <div class="opt-body">
      <div class="opt-title">Cash Advance $206 ‚Äî Review Purpose</div>
      <div class="opt-desc">A $206 cash advance on the credit card. Cash advances carry high fees and interest from day one. Determine the purpose and correct category.</div>
      <div class="opt-action">üìã Action: Review credit card statement. Categorize appropriately.</div>
    </div>
    <span class="badge badge-amber">Investigate</span>
  </div>
</div>

<!-- HOW TO UPDATE TAB -->

<!-- ===== PROPERTY CHARTS TAB ===== -->
<div id="tab-propertycharts" class="tab-content">
  <h2 style="margin:0 0 18px;font-size:1.3rem;color:#1e293b;">üè† Property Room Collections</h2>

  <!-- Property Selector -->
  <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:16px;" id="propChartTabs">
    <button onclick="selectPropChart('p3')" id="pct-p3" style="padding:7px 14px;border-radius:20px;border:none;cursor:pointer;font-size:0.85rem;font-weight:600;transition:all .2s;background:#6366f1;color:#fff;">19817 N 5th Dr</button>
    <button onclick="selectPropChart('p5')" id="pct-p5" style="padding:7px 14px;border-radius:20px;border:none;cursor:pointer;font-size:0.85rem;font-weight:600;transition:all .2s;background:#e2e8f0;color:#475569;">14802 N 38th Dr</button>
    <button onclick="selectPropChart('p6')" id="pct-p6" style="padding:7px 14px;border-radius:20px;border:none;cursor:pointer;font-size:0.85rem;font-weight:600;transition:all .2s;background:#e2e8f0;color:#475569;">2302 E Janice Way</button>
    <button onclick="selectPropChart('p7')" id="pct-p7" style="padding:7px 14px;border-radius:20px;border:none;cursor:pointer;font-size:0.85rem;font-weight:600;transition:all .2s;background:#e2e8f0;color:#475569;">4029 W Grandview Rd</button>
    <button onclick="selectPropChart('p8')" id="pct-p8" style="padding:7px 14px;border-radius:20px;border:none;cursor:pointer;font-size:0.85rem;font-weight:600;transition:all .2s;background:#e2e8f0;color:#475569;">8229 S 25th St</button>
    <button onclick="selectPropChart('p1')" id="pct-p1" style="padding:7px 14px;border-radius:20px;border:none;cursor:pointer;font-size:0.85rem;font-weight:600;transition:all .2s;background:#e2e8f0;color:#475569;">Mesa (LTR)</button>
    <button onclick="selectPropChart('p2')" id="pct-p2" style="padding:7px 14px;border-radius:20px;border:none;cursor:pointer;font-size:0.85rem;font-weight:600;transition:all .2s;background:#e2e8f0;color:#475569;">13th Ave (LTR)</button>
  </div>

  <!-- Month Toggle -->
  <div style="display:flex;gap:6px;margin-bottom:20px;align-items:center;">
    <span style="font-size:0.8rem;color:#64748b;font-weight:600;margin-right:4px;">VIEW:</span>
    <button onclick="selectPropMonth('2026-01')" id="pm-2026-01" style="padding:5px 14px;border-radius:16px;border:none;cursor:pointer;font-size:0.8rem;font-weight:600;background:#3b82f6;color:#fff;">Jan 2026</button>
    <button onclick="selectPropMonth('2026-02')" id="pm-2026-02" style="padding:5px 14px;border-radius:16px;border:none;cursor:pointer;font-size:0.8rem;font-weight:600;background:#e2e8f0;color:#475569;">Feb 2026</button>
    <button onclick="selectPropMonth('YTD')" id="pm-YTD" style="padding:5px 14px;border-radius:16px;border:none;cursor:pointer;font-size:0.8rem;font-weight:600;background:#e2e8f0;color:#475569;">YTD 2026</button>
  </div>

  <!-- Chart Area -->
  <div style="background:#fff;border-radius:12px;padding:20px;box-shadow:0 1px 4px rgba(0,0,0,0.08);margin-bottom:20px;">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
      <div id="propChartTitle" style="font-size:1rem;font-weight:700;color:#1e293b;"></div>
      <div style="display:flex;gap:16px;font-size:0.75rem;">
        <span><span style="display:inline-block;width:12px;height:12px;background:#6366f1;border-radius:2px;margin-right:4px;"></span>Base Dues</span>
        <span><span style="display:inline-block;width:12px;height:12px;background:#ef4444;border-radius:2px;margin-right:4px;"></span>Late Fees</span>
        <span><span style="display:inline-block;width:12px;height:12px;background:#10b981;border-radius:2px;margin-right:4px;"></span>Net to Host</span>
      </div>
    </div>
    <canvas id="propRoomChart" height="380"></canvas>
  </div>

  <!-- Detail Table -->
  <div style="background:#fff;border-radius:12px;padding:20px;box-shadow:0 1px 4px rgba(0,0,0,0.08);overflow-x:auto;">
    <h3 style="margin:0 0 14px;font-size:0.95rem;color:#1e293b;">üìã Room Detail Breakdown</h3>
    <table id="propRoomTable" style="width:100%;border-collapse:collapse;font-size:0.82rem;">
      <thead>
        <tr style="background:#f8fafc;border-bottom:2px solid #e2e8f0;">
          <th style="padding:8px 10px;text-align:left;color:#475569;font-weight:700;">Room</th>
          <th style="padding:8px 10px;text-align:left;color:#475569;font-weight:700;">Tenant</th>
          <th style="padding:8px 10px;text-align:right;color:#475569;font-weight:700;">Base Dues</th>
          <th style="padding:8px 10px;text-align:right;color:#ef4444;font-weight:700;">Late Fees</th>
          <th style="padding:8px 10px;text-align:right;color:#6b7280;font-weight:700;">Platform Fees</th>
          <th style="padding:8px 10px;text-align:right;color:#10b981;font-weight:700;">Net to Host</th>
          <th style="padding:8px 10px;text-align:center;color:#475569;font-weight:700;">Source</th>
          <th style="padding:8px 10px;text-align:center;color:#475569;font-weight:700;">Status</th>
        </tr>
      </thead>
      <tbody id="propRoomTableBody"></tbody>
      <tfoot id="propRoomTableFoot"></tfoot>
    </table>
  </div>

  <!-- Late Fees Summary -->
  <div id="lateFeesSummary" style="margin-top:16px;"></div>

  <!-- Addenda -->
  <div style="margin-top:14px;padding:12px 16px;background:#f0f9ff;border-left:3px solid #3b82f6;border-radius:6px;font-size:0.78rem;color:#475569;line-height:1.6;">
    <strong>üìå Chart Notes:</strong>
    <ul style="margin:6px 0 0;padding-left:18px;">
      <li><strong>Base Dues</strong> = Regular monthly rent/membership dues collected per room</li>
      <li><strong>Late Fees</strong> = Additional charges for late payment (stacked on top of dues bar in red)</li>
      <li><strong>Net to Host</strong> = What actually hits your bank after PadSplit platform fees (service + booking + txn fees)</li>
      <li><strong>Platform Fees</strong> = PadSplit booking fees (for new members) + service fee % + transaction fee % ‚Äî not shown on bar but in table</li>
      <li><strong>Direct/LTR rooms</strong> = Net equals gross (no platform fee deduction); Venmo/Zelle/Rent Perfect amounts as received</li>
      <li><strong>‚ö†Ô∏è Feb 2026 data is partial</strong> ‚Äî pulled through 2/24. Final numbers will be slightly higher once month closes.</li>
    </ul>
  </div>
</div>


<div id="tab-howto" class="tab-content">
  <h2 style="color:#c9a84c;margin-bottom:20px">üìã How to Update ‚Äî Monthly Workflow</h2>

  <div class="how-to-card">
    <div class="how-to-title">üìÖ Every Month (1st‚Äì3rd): Upload Statements</div>
    <div class="how-to-sub">Do this within the first 3 days of each month so your P&L report is ready by the 5th.</div>
    <ul class="step-list">
      <li><span class="step-num">1</span><div class="step-text">Log into <strong>Chase Online</strong> ‚Üí Download statements for:<br>
        ‚Ä¢ <strong>Chase Business Checking</strong> (main account)<br>
        ‚Ä¢ <strong>Chase Southwest Card (7623)</strong><br>
        ‚Ä¢ <strong>Chase Amazon Prime Card (8986)</strong></div></li>
      <li><span class="step-num">2</span><div class="step-text"><strong>Upload all 3 files</strong> to Tasklet ‚Äî drag and drop in the chat</div></li>
      <li><span class="step-num">3</span><div class="step-text"><strong>Pull PadSplit CSV:</strong> padsplit.com ‚Üí Dashboard ‚Üí Earnings ‚Üí select month ‚Üí Export CSV ‚Üí extract zip ‚Üí upload <code style="background:#0d1b2e;padding:2px 6px;border-radius:4px">collected</code> file to Tasklet</div></li>
      <li><span class="step-num">4</span><div class="step-text"><strong>Pull Airbnb Transaction History:</strong> airbnb.com ‚Üí Earnings ‚Üí Transaction History ‚Üí filter by month ‚Üí Export CSV ‚Üí upload to Tasklet</div></li>
      <li><span class="step-num">5</span><div class="step-text"><strong>Pull Home Depot PO# list</strong> (if HD purchases that month) ‚Äî HD Pro ‚Üí Order History ‚Üí export with PO numbers ‚Üí upload to Tasklet</div></li>
      <li><span class="step-num">6</span><div class="step-text"><strong>Pull Zelle report</strong> from Chase with memo/notes field</div></li>
    </ul>
  </div>

  <div class="how-to-card">
    <div class="how-to-title">üìä On the 5th: Auto-Generated P&amp;L Report</div>
    <div class="how-to-sub">Tasklet automatically generates your monthly P&amp;L report and emails it on the 5th of each month.</div>
    <div class="note-banner">‚è∞ Upload by the 3rd to ensure the 5th report is complete.</div>
  </div>

  <div class="how-to-card">
    <div class="how-to-title">üí∞ Income Sources to Reconcile Monthly</div>
    <ul class="income-source-list">
      <li><strong>PadSplit</strong> ‚Äî Lump sum deposits by property. Use PadSplit CSV to break down. <span>5 properties</span></li>
      <li><strong>Rent Perfect</strong> ‚Äî Direct deposits (net of $3.95/tenant fee). Auto-matched by amount. <span>Mesa, 13th, Isaiah (Lilliana pays), Michael, Terry Grice</span></li>
      <li><strong>Selyna (38th Dr Rm 4)</strong> ‚Äî Venmo ‚Üí manual transfer. Base $462.50 semi-monthly + $10/day late fees. <span>Bi-monthly</span></li>
      <li><strong>Airbnb</strong> ‚Äî Direct payouts. Long-stay bookings split into installments. Use export to match properties. <span>Multiple properties</span></li>
      <li><strong>Jarrett / Jerrod Jesse (Grandview Rm 5)</strong> ‚Äî Zelle as "Jerrod Contractor" ‚Äî $1,200/mo <span>Monthly</span></li>
      <li><strong>Omar Hamad (Grandview Rm 1)</strong> ‚Äî Zelle ‚Äî $1,800 through 3/28/2026 <span>Grandview</span></li>
      <li><strong>Ian Decker (13th Ave)</strong> ‚Äî Rent Perfect ‚Äî $2,480/mo <span>Monthly</span></li>
      <li><strong>Ricardo Vizcarra (Mesa Unit 32)</strong> ‚Äî Rent Perfect or Zelle ‚Äî $2,113.95/mo <span>Monthly</span></li>
    </ul>
  </div>

  <div class="how-to-card" style="border-left:4px solid #f59e0b">
    <div class="how-to-title">üì± Zelle Step-by-Step Pull Instructions</div>
    <div class="how-to-sub">Pull Zelle data monthly. Current pull range: <strong>start from 2/25/2026</strong> (pull around April 1 for March data).</div>
    <ul class="step-list">
      <li><span class="step-num">1</span><div class="step-text">Log into <strong>Chase Online</strong> (desktop browser)</div></li>
      <li><span class="step-num">2</span><div class="step-text">Go to <strong>Pay and Transfer</strong> ‚Üí <strong>Activity</strong> (top menu)</div></li>
      <li><span class="step-num">3</span><div class="step-text">Click <strong>ZELLE PAYMENT ACTIVITY</strong> (left side menu)</div></li>
      <li><span class="step-num">4</span><div class="step-text">Pull <strong>Money Received</strong> first ‚Äî set custom date range ‚Üí <strong>Print to PDF</strong> (Ctrl+P / Cmd+P ‚Üí Save as PDF)</div></li>
      <li><span class="step-num">5</span><div class="step-text">Pull <strong>Money Sent</strong> ‚Äî same custom date range ‚Üí Print to PDF</div></li>
      <li><span class="step-num">6</span><div class="step-text">Upload both PDFs to Tasklet ‚Äî agent reads memos and assigns tenants/properties automatically</div></li>
    </ul>
    <div class="note-banner">‚ö†Ô∏è PDF is the only export format available for Zelle. Always note the end date of your pull so next month starts from the right date. Currently pulled through <strong>2/24/2026</strong>.</div>
  </div>

  <div class="how-to-card" style="border-left:4px solid #a78bfa">
    <div class="how-to-title">üèóÔ∏è Home Depot PO Assignment</div>
    <div class="how-to-sub">Pull monthly Home Depot transaction list with PO/Job Name column for auto property assignment.</div>
    <ul class="step-list">
      <li><span class="step-num">1</span><div class="step-text">Go to <strong>homedepot.com</strong> ‚Üí Pro account ‚Üí Purchase History ‚Üí Export CSV with PO numbers</div></li>
      <li><span class="step-num">2</span><div class="step-text">Upload CSV to Tasklet ‚Äî agent reads PO/Job Name column to assign each purchase to a property</div></li>
    </ul>
    <div class="how-to-sub" style="margin-top:10px"><strong>PO Name ‚Üí Property mapping:</strong></div>
    <ul class="step-list" style="margin-top:6px">
      <li><span class="step-num" style="background:#fff">üìç</span><div class="step-text"><code style="background:#0d1b2e;padding:2px 6px;border-radius:4px">4029 / grandview / Grand View / gradview / greenview filters</code> ‚Üí <strong>Grandview</strong></div></li>
      <li><span class="step-num" style="background:#fff">üìç</span><div class="step-text"><code style="background:#0d1b2e;padding:2px 6px;border-radius:4px">8229</code> ‚Üí <strong>25th St</strong></div></li>
      <li><span class="step-num" style="background:#fff">üìç</span><div class="step-text"><code style="background:#0d1b2e;padding:2px 6px;border-radius:4px">14802</code> ‚Üí <strong>38th Dr</strong></div></li>
      <li><span class="step-num" style="background:#fff">‚ö†Ô∏è</span><div class="step-text">PO = <code style="background:#0d1b2e;padding:2px 6px;border-radius:4px">0</code> or blank ‚Üí <strong>Flagged for manual review</strong></div></li>
    </ul>
  </div>

  <div class="how-to-card" style="border-left:4px solid #34d399">
    <div class="how-to-title">üîë Tenant Payment Quick Reference</div>
    <div class="how-to-sub">How each tenant pays and what to look for each month.</div>
    <div class="table-wrap">
    <table class="data-table">
      <thead><tr><th>Tenant</th><th>Property / Room</th><th>Method</th><th>Amount</th><th>Notes</th></tr></thead>
      <tbody>
        <tr><td>PadSplit members</td><td>All 5 co-living</td><td>PadSplit lump sum</td><td>Varies by property</td><td>Match deposit to PadSplit CSV "collected" file</td></tr>
        <tr><td>Jarrett (Jerrod Jesse)</td><td>Grandview Rm 5</td><td>Zelle</td><td>$1,200/mo</td><td>Shows as "Jerrod Contractor" in Zelle</td></tr>
        <tr><td>Omar Hamad</td><td>Grandview Rm 1</td><td>Zelle</td><td>$1,800 total through 3/28/26</td><td>Short-term tenant</td></tr>
        <tr><td>Selyna</td><td>38th Dr Rm 4</td><td>Venmo ‚Üí transfer</td><td>$462.50 base + $10/day late</td><td>Bi-monthly, variable. Jan: $500+$625, Feb: $452.50+$462.50</td></tr>
        <tr><td>Michael Little</td><td>Janice Rm 6</td><td>Rent Perfect</td><td>~$976.05 net</td><td>House manager. Net of $3.95 fee</td></tr>
        <tr><td>Terrie</td><td>Janice Rm 8</td><td>Rent Perfect</td><td>~$960 net</td><td>Moved from Rm 7. Net of $3.95 fee</td></tr>
        <tr><td>Isaiah (Lilliana pays)</td><td>25th St Rm 6</td><td>Rent Perfect</td><td>$903.95 net</td><td>Lilliana Sundeen pays on behalf of Isaiah</td></tr>
        <tr><td>Ricardo Vizcarra</td><td>Mesa Unit 32</td><td>Rent Perfect or Zelle</td><td>$2,113.95/mo</td><td>Net ~$2,110 after $3.95 fee</td></tr>
        <tr><td>Ian Decker</td><td>17442 N 13th Ave</td><td>Rent Perfect</td><td>$2,480/mo</td><td>Net ~$2,476.05 after $3.95 fee</td></tr>
        <tr><td>Airbnb guests</td><td>Multiple</td><td>Airbnb direct payout</td><td>Net of Airbnb fees</td><td>Match to Airbnb CSV by reservation/payout date</td></tr>
      </tbody>
    </table>
    </div>
  </div>

  <div class="how-to-card" style="border-left:4px solid #4ade80">
    <div class="how-to-title">üè† Active Properties Quick Reference</div>
    <div class="table-wrap">
    <table class="data-table">
      <thead><tr><th>Property</th><th>Address</th><th>Lender</th><th>Rate</th><th>Payment</th><th>Income Type</th></tr></thead>
      <tbody>
        <tr><td>Mesa Unit 32</td><td>125 N 22nd Pl #32</td><td>PennyMac</td><td>4.5%</td><td>$1,124.78</td><td>Long-term (Ricardo)</td></tr>
        <tr><td>13th Ave</td><td>17442 N 13th Ave</td><td>Mtn America</td><td>7.375%</td><td>$2,418.35</td><td>Long-term (Ian Decker)</td></tr>
        <tr><td>5th Dr</td><td>19817 N 5th Dr</td><td>PennyMac</td><td>6.375%</td><td>$2,419.48</td><td>PadSplit</td></tr>
        <tr><td>38th Dr</td><td>14802 N 38th Dr</td><td>ShellPoint</td><td>7.125%</td><td>$2,594.95</td><td>PadSplit + Selyna</td></tr>
        <tr><td>Janice Way</td><td>2302 E Janice Way</td><td>Mtn America</td><td>6.75%</td><td>$3,428.05</td><td>PadSplit + Airbnb + RP</td></tr>
        <tr><td>Grandview</td><td>4029 W Grandview Rd</td><td>Capital Fund 1</td><td>10.5%‚Üí6.75%</td><td>$3,763‚Üí$3,812</td><td>PadSplit + Airbnb + Zelle</td></tr>
        <tr><td>25th St</td><td>8229 S 25th St</td><td>ShellPoint</td><td>7.125%</td><td>$2,420.24</td><td>PadSplit + Airbnb + RP</td></tr>
      </tbody>
    </table>
    </div>
  </div>

    <div class="how-to-title" style="margin-top:36px">üõ†Ô∏è Managing This Dashboard Without Tasklet</div>
    <div class="how-to-sub">If you ever need to update this dashboard manually ‚Äî without AI assistance ‚Äî here's exactly how to do it.</div>

    <div style="background:#0a1628;border:1px solid #c9a84c;border-radius:10px;padding:20px 24px;margin-bottom:24px">
      <div style="font-size:15px;font-weight:700;color:#444;margin-bottom:10px">üìÅ Where Everything Lives</div>
      <ul style="color:#e8eaf0;font-size:13px;line-height:2;margin:0;padding-left:18px">
        <li><strong>This dashboard file</strong> is stored on GitHub at:<br>
          <code style="background:#0d1b2e;padding:3px 8px;border-radius:4px;color:#c9a84c">github.com/thrivewellCL/dashboard</code> ‚Üí file named <code style="background:#0d1b2e;padding:3px 8px;border-radius:4px;color:#c9a84c">index.html</code></li>
        <li><strong>GitHub login:</strong> Username <code style="background:#0d1b2e;padding:3px 8px;border-radius:4px">thrivewellCL</code> ‚Äî use the password you set when creating the account</li>
        <li><strong>Dashboard password gate:</strong> <code style="background:#0d1b2e;padding:3px 8px;border-radius:4px">Co-Living@654123</code></li>
        <li>All data (income, expenses, charts) is <strong>hardcoded directly in the HTML file</strong> ‚Äî no external database needed</li>
      </ul>
    </div>

    <div class="how-to-title" style="font-size:15px;margin-bottom:8px">‚úèÔ∏è How to Edit Numbers Directly on GitHub</div>
    <ul class="step-list">
      <li><span class="step-num">1</span><div class="step-text">Go to <strong>github.com</strong> ‚Üí log in as <strong>thrivewellCL</strong></div></li>
      <li><span class="step-num">2</span><div class="step-text">Go to your repository: <strong>thrivewellCL/dashboard</strong> ‚Üí click <strong>index.html</strong></div></li>
      <li><span class="step-num">3</span><div class="step-text">Click the <strong>pencil icon ‚úèÔ∏è</strong> (top right of the file view) to open the editor</div></li>
      <li><span class="step-num">4</span><div class="step-text">Use <strong>Ctrl+F</strong> (or Cmd+F on Mac) to search for the number you want to change ‚Äî e.g. search <code style="background:#0d1b2e;padding:2px 6px;border-radius:4px">36143</code> to find January gross income</div></li>
      <li><span class="step-num">5</span><div class="step-text">Edit the number directly. <strong>Be careful</strong> ‚Äî only change the value, not the surrounding code</div></li>
      <li><span class="step-num">6</span><div class="step-text">Scroll to the bottom ‚Üí click <strong>"Commit changes"</strong> ‚Üí click <strong>"Commit directly to main"</strong> ‚Üí click green <strong>Commit changes</strong> button</div></li>
      <li><span class="step-num">7</span><div class="step-text">Wait <strong>2‚Äì3 minutes</strong> ‚Üí hard refresh your dashboard (Ctrl+Shift+R or Cmd+Shift+R) ‚Üí changes are live</div></li>
    </ul>

    <div class="how-to-title" style="font-size:15px;margin-bottom:8px;margin-top:24px">üî¢ Key Numbers to Update Each Month</div>
    <div class="table-wrap">
    <table class="data-table">
      <thead><tr><th>What to Update</th><th>Search For</th><th>Where It Appears</th></tr></thead>
      <tbody>
        <tr><td><strong>Monthly income per property</strong></td><td>The property name + income amount</td><td>Properties P&amp;L tab + Overview charts</td></tr>
        <tr><td><strong>Monthly expenses per property</strong></td><td>The property name + expense amount</td><td>Properties P&amp;L tab + Expenses tab</td></tr>
        <tr><td><strong>Overview totals (gross income, NOI, etc.)</strong></td><td><code>grossIncome</code>, <code>totalExpenses</code>, <code>noi</code></td><td>Overview tab stat cards</td></tr>
        <tr><td><strong>Monthly P&amp;L chart data</strong></td><td><code>monthlyPL</code></td><td>Overview chart ‚Äî bar graph</td></tr>
        <tr><td><strong>Utility amounts</strong></td><td>Utility provider name (e.g. APS, SRP, Cox)</td><td>Utilities tab</td></tr>
        <tr><td><strong>Needs Review items</strong></td><td><code>needsReview</code></td><td>Needs Review tab</td></tr>
      </tbody>
    </table>
    </div>

    <div class="how-to-title" style="font-size:15px;margin-bottom:8px;margin-top:24px">üí° Alternative: Use Another AI Tool</div>
    <div style="background:#0a1628;border:1px solid #2a3a50;border-radius:10px;padding:18px 22px;margin-bottom:24px">
      <p style="color:#444;font-size:13px;line-height:1.8;margin:0 0 10px">If you use another AI assistant (ChatGPT, Claude, etc.), you can update this dashboard by:</p>
      <ol style="color:#e8eaf0;font-size:13px;line-height:2;margin:0;padding-left:18px">
        <li>Download the <strong>index.html</strong> file from GitHub (click the file ‚Üí click download icon)</li>
        <li>Upload it to any AI chat along with your new bank statements</li>
        <li>Ask: <em>"Update the financial numbers in this dashboard HTML file with the new data from these statements"</em></li>
        <li>Download the updated HTML file the AI produces</li>
        <li>Go to GitHub ‚Üí <strong>thrivewellCL/dashboard</strong> ‚Üí click <strong>index.html</strong> ‚Üí click ‚úèÔ∏è pencil ‚Üí click the <strong>three dots menu (‚ãØ)</strong> ‚Üí <strong>Upload file</strong> ‚Üí replace with new file</li>
        <li>Wait 2‚Äì3 min ‚Üí hard refresh dashboard</li>
      </ol>
      <p style="color:#8899aa;font-size:12px;margin:10px 0 0">üí¨ <strong>Tip:</strong> Give the AI this context: "This is a real estate investment dashboard for 7 properties. Update the monthly P&L numbers, keep all formatting and password protection intact."</p>
    </div>

    <div class="how-to-title" style="font-size:15px;margin-bottom:8px;margin-top:24px">üîê Important Credentials to Save Somewhere Safe</div>
    <div style="background:#0a1628;border:1px solid #e05252;border-radius:10px;padding:18px 22px;margin-bottom:12px">
      <table class="data-table" style="margin:0">
        <thead><tr><th>Service</th><th>Username / Login</th><th>What It's For</th></tr></thead>
        <tbody>
          <tr><td><strong>GitHub</strong></td><td>thrivewellCL</td><td>Dashboard file storage &amp; publishing</td></tr>
          <tr><td><strong>Dashboard Password</strong></td><td>Co-Living@654123</td><td>Access gate on the live dashboard</td></tr>
          <tr><td><strong>Live Dashboard URL</strong></td><td>thrivewellcl.github.io/dashboard</td><td>Share with accountant, partners, etc.</td></tr>
          <tr><td><strong>Google Calendar</strong></td><td>ferraragroupltd@gmail.com</td><td>Monthly statement reminders (1st‚Äì3rd)</td></tr>
        </tbody>
      </table>
      <p style="color:#444;font-size:12px;margin:12px 0 0">‚ö†Ô∏è <strong>Save these credentials in a password manager or secure note.</strong> Without GitHub access you cannot update the dashboard.</p>
    </div>

  </div>
</div>

<script>
// ---- Tab Switching ----
function showTab(id) {
  document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  const el = document.getElementById('tab-' + id);
  if (el) el.classList.add('active');
  document.querySelectorAll('.tab-btn').forEach(b => {
    if (b.getAttribute('onclick') && b.getAttribute('onclick').includes("'" + id + "'")) b.classList.add('active');
  });
  if (id === 'prop-charts') { setTimeout(function(){ renderPropChart(); }, 50); }
}

// ---- Collapsible ----
function toggleCollapsible(id) {
  const el = document.getElementById(id);
  if (el) el.classList.toggle('open');
}

// ---- LocalStorage for Review Items ----
const STORAGE_KEY = 'ferrara_review_changes';
function loadChanges() {
  try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch(e) { return {}; }
}
function saveChanges(data) {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
  updatePendingCount();
}
function updatePendingCount() {
  const data = loadChanges();
  const count = Object.keys(data).length;
  const el = document.getElementById('pendingCount');
  if (el) el.textContent = 'Pending Changes: ' + count;
}

function editRow(id) {
  const data = loadChanges();
  const cat = document.getElementById('cat-' + id);
  const prop = document.getElementById('prop-' + id);
  const notes = document.getElementById('notes-' + id);
  data[id] = {
    category: cat ? cat.value : '',
    property: prop ? prop.value : '',
    notes: notes ? notes.value : '',
    status: 'Updated',
    ts: new Date().toISOString()
  };
  saveChanges(data);
  const badge = document.getElementById('status-' + id);
  if (badge) { badge.textContent = 'Updated'; badge.className = 'badge badge-blue'; }
  const row = document.getElementById('rr-' + id);
  if (row) row.classList.add('edited');
}

function resolveRow(id) {
  const data = loadChanges();
  const cat = document.getElementById('cat-' + id);
  const prop = document.getElementById('prop-' + id);
  const notes = document.getElementById('notes-' + id);
  data[id] = {
    category: cat ? cat.value : '',
    property: prop ? prop.value : '',
    notes: notes ? notes.value : '',
    status: 'Resolved',
    ts: new Date().toISOString()
  };
  saveChanges(data);
  const badge = document.getElementById('status-' + id);
  if (badge) { badge.textContent = 'Resolved'; badge.className = 'badge badge-green'; }
  const row = document.getElementById('rr-' + id);
  if (row) {
    row.classList.add('edited');
    row.style.opacity = '0.6';
    // Move to resolved group
    const rc = document.getElementById('resolvedContainer');
    if (rc) {
      if (rc.textContent.includes('No items')) rc.textContent = '';
      const desc = row.querySelector('.review-desc');
      const div = document.createElement('div');
      div.style.cssText = 'padding:8px 12px;border-bottom:1px solid #1a2d4a;font-size:13px;color:#4ade80';
      div.textContent = '‚úÖ ' + (desc ? desc.textContent : id) + ' ‚Äî Resolved ' + new Date().toLocaleString();
      rc.appendChild(div);
    }
  }
}

function copyChangesSummary() {
  const data = loadChanges();
  if (Object.keys(data).length === 0) {
    alert('No changes recorded yet. Edit items in the Needs Review tab first.');
    return;
  }
  let txt = 'FERRARA GROUP ‚Äî REVIEW CHANGES SUMMARY\n';
  txt += 'Generated: ' + new Date().toLocaleString() + '\n\n';
  for (const [id, v] of Object.entries(data)) {
    txt += '--- ' + id.toUpperCase() + ' ---\n';
    txt += 'Status: ' + v.status + '\n';
    if (v.category) txt += 'Category: ' + v.category + '\n';
    if (v.property) txt += 'Property: ' + v.property + '\n';
    if (v.notes) txt += 'Notes: ' + v.notes + '\n';
    txt += '\n';
  }
  navigator.clipboard.writeText(txt).then(() => alert('Changes copied to clipboard!')).catch(() => alert('Copy failed. Please try again.'));
}

// ---- Expense Table ----
const expenses = [
  {date:'2026-02-20',desc:'Selyna Venmo (38th Rm4)',amount:462.50,cat:'Rent Income',prop:'38th Dr',acct:'Venmo',review:0,income:true},
  {date:'2026-02-20',desc:'Jerrod Jesse Zelle (Grandview Rm5)',amount:1200,cat:'Rent Income',prop:'Grandview',acct:'Checking',review:0,income:true},
  {date:'2026-02-20',desc:'Omar Hamad Zelle (Grandview Rm1)',amount:1800,cat:'Rent Income',prop:'Grandview',acct:'Checking',review:1,income:true},
  {date:'2026-02-13',desc:'Matthew Castle Airbnb (Janice Rm7)',amount:849.72,cat:'Rent Income',prop:'Janice Way',acct:'Airbnb',review:0,income:true},
  {date:'2026-02-10',desc:'Davien Alston Airbnb Install 2 (Janice Rm3)',amount:1045.97,cat:'Rent Income',prop:'Janice Way',acct:'Airbnb',review:0,income:true},
  {date:'2026-02-09',desc:'Davien Alston Airbnb Install 1 (Janice Rm3)',amount:843.86,cat:'Rent Income',prop:'Janice Way',acct:'Airbnb',review:0,income:true},
  {date:'2026-02-09',desc:'Conor Hart Airbnb (25th St Rm7)',amount:1235.59,cat:'Rent Income',prop:'25th St',acct:'Airbnb',review:0,income:true},
  {date:'2026-02-06',desc:'Selyna Venmo - FLAGGED low payment',amount:52.50,cat:'Rent Income',prop:'38th Dr',acct:'Venmo',review:1,income:true},
  {date:'2026-02-05',desc:'Bljerim Ibraimi Airbnb (Grandview Rm8-9)',amount:2741.61,cat:'Rent Income',prop:'Grandview',acct:'Airbnb',review:0,income:true},
  {date:'2026-02-01',desc:'APS Electric - Janice Way',amount:289.08,cat:'Utilities - Electric',prop:'Janice Way',acct:'Checking',review:0,income:false},
  {date:'2026-02-01',desc:'Cox Internet - Janice Way MAIN',amount:90.00,cat:'Utilities - Internet',prop:'Janice Way',acct:'Checking',review:0,income:false},
  {date:'2026-02-01',desc:'Cox Internet - Janice Way DUPLICATE ‚ö†Ô∏è',amount:125.40,cat:'Utilities - Internet',prop:'Janice Way',acct:'Checking',review:1,income:false},
  {date:'2026-02-01',desc:'Southwest Gas - Janice Way',amount:98.72,cat:'Utilities - Gas',prop:'Janice Way',acct:'Checking',review:0,income:false},
  {date:'2026-02-01',desc:'Southwest Gas - 38th Dr',amount:98.72,cat:'Utilities - Gas',prop:'38th Dr',acct:'Checking',review:0,income:false},
  {date:'2026-02-01',desc:'Southwest Gas - 25th St',amount:63.65,cat:'Utilities - Gas',prop:'25th St',acct:'Checking',review:0,income:false},
  {date:'2026-02-01',desc:'APS Electric - 5th Dr',amount:64.00,cat:'Utilities - Electric',prop:'5th Dr',acct:'Checking',review:0,income:false},
  {date:'2026-02-01',desc:'APS Electric - Grandview',amount:68.97,cat:'Utilities - Electric',prop:'Grandview',acct:'Checking',review:0,income:false},
  {date:'2026-02-01',desc:'APS Electric - 38th Dr',amount:96.49,cat:'Utilities - Electric',prop:'38th Dr',acct:'Checking',review:0,income:false},
  {date:'2026-02-17',desc:'Ricardo Vizcarra Zelle (Mesa) ‚Äî RP canceled, paid via Zelle',amount:2113.95,cat:'Rent Income',prop:'Mesa Unit 32',acct:'Checking',review:0,income:true},
  {date:'2026-02-01',desc:'PadSplit Host Payment - 5th Dr (thru 2/24)',amount:4742.33,cat:'Rent Income',prop:'5th Dr',acct:'Checking',review:0,income:true},
  {date:'2026-02-01',desc:'PadSplit Host Payment - Janice Way',amount:2258.60,cat:'Rent Income',prop:'Janice Way',acct:'Checking',review:0,income:true},
  {date:'2026-02-01',desc:'PadSplit Host Payment - 38th Dr',amount:3177.07,cat:'Rent Income',prop:'38th Dr',acct:'Checking',review:0,income:true},
  {date:'2026-02-01',desc:'PadSplit Host Payment - 25th St',amount:3529.91,cat:'Rent Income',prop:'25th St',acct:'Checking',review:0,income:true},
  {date:'2026-02-01',desc:'PadSplit Host Payment - Grandview',amount:2528.92,cat:'Rent Income',prop:'Grandview',acct:'Checking',review:0,income:true},
  {date:'2026-01-23',desc:'Selyna Venmo - Jan 2 w/ late fee',amount:625.00,cat:'Rent Income',prop:'38th Dr',acct:'Venmo',review:0,income:true},
  {date:'2026-01-20',desc:'Jonatan Landscaping - Janice Way',amount:364.86,cat:'Landscaping & Junk Removal',prop:'Janice Way',acct:'Checking',review:0,income:false},
  {date:'2026-01-20',desc:'Gabriel Carpet - Janice Way',amount:320.90,cat:'Repairs & Labor',prop:'Janice Way',acct:'Checking',review:0,income:false},
  {date:'2026-01-20',desc:'Terry CO-Living - Grandview flyers',amount:105.00,cat:'Marketing & Photography',prop:'Grandview',acct:'Checking',review:0,income:false},
  {date:'2026-01-20',desc:'Juan Electric - Grandview final setup',amount:800.00,cat:'Repairs & Labor',prop:'Grandview',acct:'Checking',review:0,income:false},
  {date:'2026-01-20',desc:'Juan Electric - 25th St maintenance',amount:120.00,cat:'Repairs & Labor',prop:'25th St',acct:'Checking',review:0,income:false},
  {date:'2026-01-20',desc:'Jerrod Jesse Zelle x2 (Grandview Rm5 partial)',amount:1120.00,cat:'Rent Income',prop:'Grandview',acct:'Checking',review:0,income:true},
  {date:'2026-01-12',desc:'Jonatan Landscaping - Grandview patios',amount:965.00,cat:'Landscaping & Junk Removal',prop:'Grandview',acct:'Checking',review:0,income:false},
  {date:'2026-01-12',desc:'Juan Electric - 38th Dr fan rm4',amount:120.00,cat:'Repairs & Labor',prop:'38th Dr',acct:'Checking',review:0,income:false},
  {date:'2026-01-09',desc:'Selyna Venmo - Jan payment',amount:500.00,cat:'Rent Income',prop:'38th Dr',acct:'Venmo',review:0,income:true},
  {date:'2026-01-07',desc:'Shannon Couch - Grandview furniture',amount:50.00,cat:'Furnishings',prop:'Grandview',acct:'Checking',review:0,income:false},
  {date:'2026-01-05',desc:'Juan Electric - Grandview mini splits',amount:500.00,cat:'Repairs & Labor',prop:'Grandview',acct:'Checking',review:0,income:false},
  {date:'2026-01-01',desc:'PadSplit Host Payment - 5th Dr',amount:4800.13,cat:'Rent Income',prop:'5th Dr',acct:'Checking',review:0,income:true},
  {date:'2026-01-01',desc:'PadSplit Host Payment - Janice Way',amount:2683.06,cat:'Rent Income',prop:'Janice Way',acct:'Checking',review:0,income:true},
  {date:'2026-01-01',desc:'PadSplit Host Payment - 38th Dr',amount:3627.61,cat:'Rent Income',prop:'38th Dr',acct:'Checking',review:0,income:true},
  {date:'2026-01-01',desc:'PadSplit Host Payment - 25th St',amount:4248.56,cat:'Rent Income',prop:'25th St',acct:'Checking',review:0,income:true},
  {date:'2026-01-01',desc:'PadSplit Host Payment - Grandview (new)',amount:366.01,cat:'Rent Income',prop:'Grandview',acct:'Checking',review:0,income:true},
  {date:'2026-01-01',desc:'APS Electric - Janice Way',amount:214.16,cat:'Utilities - Electric',prop:'Janice Way',acct:'Checking',review:0,income:false},
  {date:'2026-01-01',desc:'APS Electric - 5th Dr',amount:54.90,cat:'Utilities - Electric',prop:'5th Dr',acct:'Checking',review:0,income:false},
  {date:'2026-01-01',desc:'APS Electric - Grandview',amount:59.25,cat:'Utilities - Electric',prop:'Grandview',acct:'Checking',review:0,income:false},
  {date:'2026-01-01',desc:'APS Electric - 38th Dr',amount:76.82,cat:'Utilities - Electric',prop:'38th Dr',acct:'Checking',review:0,income:false},
  {date:'2026-01-01',desc:'SRP Electric - 25th St (2 payments)',amount:292.64,cat:'Utilities - Electric',prop:'25th St',acct:'Checking',review:0,income:false},
  {date:'2026-01-01',desc:'SRP Electric - Willow Ave (personal)',amount:190.50,cat:'Personal',prop:'Personal',acct:'Checking',review:1,income:false},
  {date:'2026-01-01',desc:'Southwest Gas - Janice Way',amount:95.47,cat:'Utilities - Gas',prop:'Janice Way',acct:'Checking',review:0,income:false},
  {date:'2026-01-01',desc:'Southwest Gas - 38th Dr',amount:89.90,cat:'Utilities - Gas',prop:'38th Dr',acct:'Checking',review:0,income:false},
  {date:'2026-01-01',desc:'Southwest Gas - 25th St',amount:63.65,cat:'Utilities - Gas',prop:'25th St',acct:'Checking',review:0,income:false},
  {date:'2026-01-01',desc:'Sunrun Solar - 5th Dr',amount:93.00,cat:'Utilities - Solar',prop:'5th Dr',acct:'Checking',review:0,income:false},
  {date:'2026-01-01',desc:'TechniArt x4 charges - VERIFY',amount:126.36,cat:'Software & Tech',prop:'',acct:'Credit Card',review:1,income:false},
  {date:'2026-01-01',desc:'Amazon - Various (82 transactions)',amount:1640.00,cat:'Materials & Supplies',prop:'',acct:'Credit Card',review:1,income:false},
  {date:'2026-01-01',desc:'Home Depot - Multiple charges',amount:482.35,cat:'Materials & Supplies',prop:'',acct:'Credit Card',review:1,income:false},
];

let currentMonth = 'all';
let currentCat = '';
let currentProp = '';

function filterExpenses() {
  const search = document.getElementById('expSearch').value.toLowerCase();
  const cat = document.getElementById('expCatFilter').value;
  const prop = document.getElementById('expPropFilter').value;
  renderExpenses(search, cat, prop, currentMonth);
}

function filterExpMonth(btn, month) {
  currentMonth = month;
  document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  filterExpenses();
}

function renderExpenses(search, cat, prop, month) {
  const tbody = document.getElementById('expBody');
  if (!tbody) return;
  let total = 0, rows = '';
  const filtered = expenses.filter(e => {
    if (month !== 'all' && !e.date.startsWith(month)) return false;
    if (cat && e.cat !== cat) return false;
    if (prop && e.prop !== prop) return false;
    if (search && !e.desc.toLowerCase().includes(search)) return false;
    return true;
  });
  filtered.forEach(e => {
    const cls = e.review ? 'needs-review' : (e.income ? 'income' : '');
    const flag = e.review ? '<span class="badge badge-red">‚ö†Ô∏è Review</span>' : '';
    const amt = e.income ? '<span style="color:#4ade80">+$' + e.amount.toFixed(2) + '</span>' : '$' + e.amount.toFixed(2);
    if (!e.income) total += e.amount;
    rows += '<tr class="' + cls + '"><td>' + e.date + '</td><td>' + e.desc + '</td><td>' + amt + '</td><td>' + e.cat + '</td><td>' + (e.prop || '<span style="color:#444">Unassigned</span>') + '</td><td>' + e.acct + '</td><td>' + flag + '</td></tr>';
  });
  tbody.innerHTML = rows || '<tr><td colspan="7" style="text-align:center;color:#8899aa;padding:20px">No matching transactions</td></tr>';
  const tot = document.getElementById('expTotal');
  if (tot) tot.textContent = '$' + total.toFixed(2) + ' (expenses)';
}

// ---- Charts ----
function initDashboard() {
  // Destroy any existing chart instances to prevent conflicts
  Chart.helpers && Object.values(Chart.instances || {}).forEach(c => c.destroy && c.destroy());
  updatePendingCount();
  renderExpenses('','','','all');
  updateUnresolvedTotal();
  initStackedExpenseChart();

  // Chart defaults
  // ‚îÄ‚îÄ‚îÄ GLOBAL CHART DEFAULTS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  Chart.defaults.color = '#8899aa';
  Chart.defaults.borderColor = 'rgba(255,255,255,0.07)';
  Chart.register(ChartDataLabels);

    // ‚îÄ‚îÄ Global dark text for all charts ‚îÄ‚îÄ
    Chart.defaults.color = '#1f2937';
    Chart.defaults.plugins.legend.labels.color = '#1f2937';
    Chart.defaults.scale.ticks.color = '#1f2937';
    Chart.defaults.scale.title.color = '#1f2937';


  // Shared tooltip style
  const tooltipDefaults = {
    backgroundColor: 'rgba(10,25,47,0.96)',
    borderColor: '#c9a84c',
    borderWidth: 1,
    titleColor: '#c9a84c',
    bodyColor: '#e8eaf0',
    padding: 12,
    cornerRadius: 8,
    titleFont: { size: 13, weight: 'bold' },
    bodyFont: { size: 13 }
  };

  // ‚îÄ‚îÄ‚îÄ OUTER LABELS PLUGIN (pie/doughnut leader lines) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const outerLabelsPlugin = {
    id: 'outerLabels',
    afterDraw(chart) {
      if (chart.config.type !== 'doughnut') return;
      const {ctx, data, chartArea} = chart;
      if (!chartArea) return;
      const cx = (chartArea.left + chartArea.right) / 2;
      const cy = (chartArea.top  + chartArea.bottom) / 2;
      const meta = chart.getDatasetMeta(0);
      if (!meta || !meta.data.length) return;
      const outerR = meta.data[0].outerRadius;
      const dataset = data.datasets[0];
      const total   = dataset.data.reduce((a,b)=>a+b,0);

      ctx.save();
      meta.data.forEach((arc, i) => {
        const midAngle = (arc.startAngle + arc.endAngle) / 2;
        const cosA = Math.cos(midAngle), sinA = Math.sin(midAngle);
        const label = data.labels[i] || '';
        const val   = dataset.data[i] || 0;
        const pct   = ((val/total)*100).toFixed(1);
        const txt1  = label;
        const txt2  = '$' + val.toLocaleString() + '  (' + pct + '%)';

        // Leader line
        const lx1 = cx + (outerR + 6)  * cosA;
        const ly1 = cy + (outerR + 6)  * sinA;
        const lx2 = cx + (outerR + 22) * cosA;
        const ly2 = cy + (outerR + 22) * sinA;
        ctx.beginPath();
        ctx.strokeStyle = dataset.backgroundColor[i];
        ctx.lineWidth = 1.5;
        ctx.moveTo(lx1, ly1);
        ctx.lineTo(lx2, ly2);
        ctx.stroke();

        // Box
        const isRight = cosA >= 0;
        const bx = cx + (outerR + 26) * cosA;
        const by = cy + (outerR + 26) * sinA;
        const pad = 6;
        ctx.font = 'bold 11px Segoe UI';
        const w1 = ctx.measureText(txt1).width;
        ctx.font = '10px Segoe UI';
        const w2 = ctx.measureText(txt2).width;
        const boxW = Math.max(w1, w2) + pad*2;
        const boxH = 30;
        const boxX = isRight ? bx : bx - boxW;
        const boxY = by - boxH/2;

        // Box background
        ctx.fillStyle = 'rgba(255,255,255,0.92)';
        ctx.strokeStyle = dataset.backgroundColor[i];
        ctx.lineWidth = 1.5;
        const r = 4;
        ctx.beginPath();
        ctx.moveTo(boxX+r, boxY);
        ctx.lineTo(boxX+boxW-r, boxY);
        ctx.quadraticCurveTo(boxX+boxW, boxY, boxX+boxW, boxY+r);
        ctx.lineTo(boxX+boxW, boxY+boxH-r);
        ctx.quadraticCurveTo(boxX+boxW, boxY+boxH, boxX+boxW-r, boxY+boxH);
        ctx.lineTo(boxX+r, boxY+boxH);
        ctx.quadraticCurveTo(boxX, boxY+boxH, boxX, boxY+boxH-r);
        ctx.lineTo(boxX, boxY+r);
        ctx.quadraticCurveTo(boxX, boxY, boxX+r, boxY);
        ctx.closePath();
        ctx.fill();
        ctx.stroke();

        // Text
        ctx.fillStyle = '#1f2937';
        ctx.font = 'bold 11px Segoe UI';
        ctx.textAlign = 'left'; ctx.textBaseline = 'middle';
        ctx.fillText(txt1, boxX+pad, boxY+9);
        ctx.font = '10px Segoe UI';
        ctx.fillStyle = '#374151';
        ctx.fillText(txt2, boxX+pad, boxY+21);
      });
      ctx.restore();
    }
  };


  function fmtDollar(v) { return '$' + Math.abs(v).toLocaleString('en-US', {minimumFractionDigits:0}); }

  // ‚îÄ‚îÄ‚îÄ 1. PROPERTY INCOME VS EXPENSES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  
    // Plugin: vertical separators between property groups
    const propertySeparatorPlugin = {
        id: 'propertySeparator',
        afterDraw(chart) {
            if (chart.config.type !== 'bar') return;
            const ctx = chart.ctx;
            const xAxis = chart.scales.x;
            if (!xAxis || !xAxis.ticks || xAxis.ticks.length < 2) return;
            
            ctx.save();
            ctx.strokeStyle = 'rgba(180,180,180,0.6)';
            ctx.lineWidth = 1.5;
            ctx.setLineDash([5, 4]);
            
            // Draw between each pair of consecutive ticks (between property groups)
            for (let i = 0; i < xAxis.ticks.length - 1; i++) {
                const x1 = xAxis.getPixelForTick(i);
                const x2 = xAxis.getPixelForTick(i + 1);
                const midX = (x1 + x2) / 2;
                ctx.beginPath();
                ctx.moveTo(midX, chart.chartArea.top);
                ctx.lineTo(midX, chart.chartArea.bottom);
                ctx.stroke();
            }
            ctx.restore();
        }
    };
    Chart.register(propertySeparatorPlugin);

    new Chart(document.getElementById('propIncomeChart'), {
    type: 'bar',
    data: {
      labels: ['5th Dr','38th Dr','Janice Way','25th St','Grandview','Mesa','13th Ave'],
      datasets: [
        {
          label:'Income (Jan)',
          data:[4800,4753,2683,4249,1486,2114,2480],
          backgroundColor: ctx => {
            const g = ctx.chart.ctx.createLinearGradient(0,0,0,300);
            g.addColorStop(0,'rgba(74,222,128,0.95)'); g.addColorStop(1,'rgba(34,197,94,0.5)');
            return g;
          },
          borderColor:'rgba(74,222,128,0.9)', borderWidth:1, borderRadius:6, borderSkipped:false
        },
        {
          label:'Expenses (Jan)',
          data:[2870,3060,4160,3270,5590,1125,2418],
          backgroundColor: ctx => {
            const g = ctx.chart.ctx.createLinearGradient(0,0,0,300);
            g.addColorStop(0,'rgba(248,113,113,0.95)'); g.addColorStop(1,'rgba(220,38,38,0.5)');
            return g;
          },
          borderColor:'rgba(248,113,113,0.9)', borderWidth:1, borderRadius:6, borderSkipped:false
        }
      ]
    },
    options: {
      responsive:true, maintainAspectRatio:false,
      plugins: {
        datalabels: {
          anchor:'end', align:'end', color:'#222', font:{size:11,weight:'bold'},
          formatter: v => '$'+v.toLocaleString()
        },
        legend:{ labels:{color:'#e8eaf0', padding:16, font:{size:12}} },
        tooltip: { ...tooltipDefaults, callbacks:{
          label: ctx => ` ${ctx.dataset.label}: ${fmtDollar(ctx.parsed.y)}`
        }}
      },
      scales:{
        x:{ticks:{color:'#8899aa'}, grid:{color:'rgba(255,255,255,0.05)'}},
        y:{ticks:{color:'#8899aa',callback:v=>'$'+v.toLocaleString()}, grid:{color:'rgba(255,255,255,0.05)'},
           suggestedMax:7000}
      }
    }
  });

  // ‚îÄ‚îÄ‚îÄ 2. EXPENSE DONUT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  (function(){
    const expData = [17849,1005,503,559,503,93,1540,1330,850,600];
    const expLabels = ['Mortgage','Electric','Gas','Internet','Water','Solar','Repairs','Landscaping','Cleaning','Other'];
    const expColors = ['#c9a84c','#fbbf24','#f97316','#a855f7','#38bdf8','#22c55e','#60a5fa','#4ade80','#f472b6','#94a3b8'];
    const total = expData.reduce((a,b)=>a+b,0);

    // Center text plugin (inline)
    const centerTextPlugin = {
      id:'centerText',
      afterDraw(chart){
        if(chart.config.type !== 'doughnut') return;
        const {ctx, chartArea:{top,bottom,left,right}} = chart;
        const cx = (left+right)/2, cy = (top+bottom)/2;
        ctx.save();
        ctx.textAlign='center'; ctx.textBaseline='middle';
        ctx.fillStyle='#c9a84c'; ctx.font='bold 18px Segoe UI';
        ctx.fillText('$'+total.toLocaleString(), cx, cy-10);
        ctx.fillStyle='#8899aa'; ctx.font='12px Segoe UI';
        ctx.fillText('Total Expenses', cx, cy+12);
        ctx.restore();
      }
    };

    new Chart(document.getElementById('expenseDonut'), {
      type: 'doughnut',
      data: {
        labels: expLabels,
        datasets:[{
          data: expData,
          backgroundColor: expColors,
          borderColor:'rgba(13,27,46,0.8)',
          borderWidth:2,
          hoverOffset:12,
          hoverBorderColor:'#c9a84c'
        }]
      },
      plugins:[centerTextPlugin, outerLabelsPlugin],
      options:{
        responsive:true, maintainAspectRatio:true, aspectRatio:1, cutout:'68%',
        layout:{ padding:70 },
        plugins:{
          datalabels:{ display:false },
          legend:{ display:false },
          tooltip:{ ...tooltipDefaults, callbacks:{
            label: ctx => {
              const pct = ((ctx.parsed/total)*100).toFixed(1);
              return ` ${fmtDollar(ctx.parsed)}  (${pct}%)`;
            }
          }}
        }
      }
    });
  })();

  // ‚îÄ‚îÄ‚îÄ 3. REVENUE BY PLATFORM (DOUGHNUT) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  (function(){
    const platData   = [31963, 9500, 9188, 28589];
    const platLabels = ['PadSplit','Airbnb','LTR (Mesa & 13th Ave)','Direct (Zelle / Venmo)'];
    const platColors = ['#4CAF50','#FF5722','#9C27B0','#2196F3'];
    const platTotal  = platData.reduce((a,b)=>a+b,0);

    const centerPlugin2 = {
      id:'centerText2',
      afterDraw(chart){
        if(chart.canvas.id !== 'vendorPieChart') return;
        const {ctx, chartArea:{top,bottom,left,right}} = chart;
        const cx=(left+right)/2, cy=(top+bottom)/2;
        ctx.save();
        ctx.textAlign='center'; ctx.textBaseline='middle';
        ctx.fillStyle='#c9a84c'; ctx.font='bold 18px Segoe UI';
        ctx.fillText('$'+platTotal.toLocaleString(), cx, cy-10);
        ctx.fillStyle='#8899aa'; ctx.font='12px Segoe UI';
        ctx.fillText('Gross Revenue', cx, cy+12);
        ctx.restore();
      }
    };

    new Chart(document.getElementById('vendorPieChart'), {
      type: 'doughnut',
      data:{
        labels: platLabels,
        datasets:[{
          data: platData,
          backgroundColor: platColors,
          borderColor:'rgba(13,27,46,0.8)',
          borderWidth:2,
          hoverOffset:14,
          hoverBorderColor:'#fff'
        }]
      },
      plugins:[centerPlugin2, outerLabelsPlugin],
      options:{
        responsive:true, maintainAspectRatio:true, aspectRatio:1, cutout:'62%',
        layout:{ padding:75 },
        plugins:{
          datalabels:{ display:false },
          legend:{ display:false },
          tooltip:{ ...tooltipDefaults, callbacks:{
            title: ctx => ctx[0].label,
            label: ctx => {
              const pct = ((ctx.parsed/platTotal)*100).toFixed(1);
              return ` ${fmtDollar(ctx.parsed)}  ¬∑  ${pct}% of revenue`;
            }
          }}
        }
      }
    });
  })();

  // ‚îÄ‚îÄ‚îÄ 4. PADSPLIT BY PROPERTY ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  new Chart(document.getElementById('padsplitChart'), {
    type:'bar',
    data:{
      labels:['5th Dr','Janice Way','38th Dr','25th St','Grandview'],
      datasets:[
        {
          label:'January',
          data:[4800,2683,3628,4249,366],
          backgroundColor: ctx => {
            const g = ctx.chart.ctx.createLinearGradient(0,0,0,260);
            g.addColorStop(0,'rgba(201,168,76,0.95)'); g.addColorStop(1,'rgba(201,168,76,0.4)');
            return g;
          },
          borderColor:'rgba(201,168,76,0.9)', borderWidth:1, borderRadius:6, borderSkipped:false
        },
        {
          label:'February (est.)',
          data:[4742,2259,3177,3530,2529],
          backgroundColor: ctx => {
            const g = ctx.chart.ctx.createLinearGradient(0,0,0,260);
            g.addColorStop(0,'rgba(96,165,250,0.95)'); g.addColorStop(1,'rgba(96,165,250,0.4)');
            return g;
          },
          borderColor:'rgba(96,165,250,0.9)', borderWidth:1, borderRadius:6, borderSkipped:false
        }
      ]
    },
    options:{
      responsive:true, maintainAspectRatio:false,
      plugins:{
        datalabels:{
          anchor:'end', align:'end', color:'#222', font:{size:10,weight:'bold'},
          formatter: v => '$'+v.toLocaleString()
        },
        legend:{ labels:{color:'#e8eaf0', padding:14, font:{size:12}} },
        tooltip:{ ...tooltipDefaults, callbacks:{
          label: ctx => ` ${ctx.dataset.label}: ${fmtDollar(ctx.parsed.y)}`
        }}
      },
      scales:{
        x:{ticks:{color:'#8899aa'}, grid:{color:'rgba(255,255,255,0.05)'}},
        y:{ticks:{color:'#8899aa',callback:v=>'$'+v.toLocaleString()}, grid:{color:'rgba(255,255,255,0.05)'},
           suggestedMax:6000}
      }
    }
  });

  // ‚îÄ‚îÄ‚îÄ 5. UTILITY STACKED (OVERVIEW) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const utilShared = {
    responsive:true,
    plugins:{
      datalabels:{
        display: ctx => ctx.dataset.data[ctx.dataIndex] > 0,
        color:'#222', font:{size:10,weight:'bold'},
        formatter: v => v>0 ? '$'+v : ''
      },
      legend:{ labels:{color:'#e8eaf0', font:{size:11}, padding:10} },
      tooltip:{ ...tooltipDefaults, mode:'index', intersect:false,
        callbacks:{
          label: ctx => ctx.parsed.y > 0 ? ` ${ctx.dataset.label}: ${fmtDollar(ctx.parsed.y)}` : null,
          footer: items => {
            const total = items.reduce((s,i)=>s+i.parsed.y,0);
            return total>0 ? `  Total: ${fmtDollar(total)}` : '';
          }
        }
      }
    },
    scales:{
      x:{stacked:true, ticks:{color:'#8899aa'}, grid:{color:'rgba(255,255,255,0.05)'}},
      y:{stacked:true, ticks:{color:'#8899aa',callback:v=>'$'+v}, grid:{color:'rgba(255,255,255,0.05)'}}
    }
  };

  new Chart(document.getElementById('utilityChart'), {
    type:'bar',
    data:{
      labels:['5th Dr','38th Dr','Janice Way','25th St','Grandview'],
      datasets:[
        {label:'Electric',data:[59,87,252,293,64],backgroundColor:'#fbbf24',borderRadius:3},
        {label:'Gas',data:[0,94,97,64,0],backgroundColor:'#f97316',borderRadius:3},
        {label:'Internet',data:[161,16,215,80,86],backgroundColor:'#a855f7',borderRadius:3},
        {label:'Water',data:[85,126,109,105,79],backgroundColor:'#38bdf8',borderRadius:3},
        {label:'Solar',data:[93,0,0,0,0],backgroundColor:'#22c55e',borderRadius:3}
      ]
    },
    options: utilShared
  });

  // ‚îÄ‚îÄ‚îÄ 6. UTILITY STACKED (UTILITIES TAB) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const utilCtx = document.getElementById('utilityStackChart');
  if(utilCtx){
    new Chart(utilCtx, {
      type:'bar',
      data:{
        labels:['5th Dr','38th Dr','Janice Way','25th St','Grandview'],
        datasets:[
          {label:'Electric',data:[59,87,252,293,64],backgroundColor:'#fbbf24',borderRadius:3},
          {label:'Gas',data:[0,94,97,64,0],backgroundColor:'#f97316',borderRadius:3},
          {label:'Internet',data:[161,16,215,80,86],backgroundColor:'#a855f7',borderRadius:3},
          {label:'Water',data:[85,126,109,105,79],backgroundColor:'#38bdf8',borderRadius:3},
          {label:'Solar',data:[93,0,0,0,0],backgroundColor:'#22c55e',borderRadius:3}
        ]
      },
      options: utilShared
    });
  }

  // ‚îÄ‚îÄ‚îÄ 7. MONTHLY P&L ‚Äî COMBO (BARS + LINE) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  new Chart(document.getElementById('monthlyPLChart'), {
    type:'bar',
    data:{
      labels:['January 2026','February 2026 (est.)'],
      datasets:[
        // Ghost income bars (wider, lighter ‚Äî depth effect)
        {
          type:'bar', label:'_incomeGhost',
          data:[36143,38200],
          backgroundColor:'rgba(144,190,109,0.22)',
          borderColor:'transparent', borderWidth:0,
          barPercentage:0.82, categoryPercentage:0.72,
          order:5, datalabels:{display:true}
        },
        // Ghost expense bars (wider, lighter, negative)
        {
          type:'bar', label:'_expenseGhost',
          data:[-12275,-11800],
          backgroundColor:'rgba(200,80,80,0.18)',
          borderColor:'transparent', borderWidth:0,
          barPercentage:0.82, categoryPercentage:0.72,
          order:5, datalabels:{display:true}
        },
        // Income bars ‚Äî green, going UP
        {
          type:'bar', label:'Gross Income',
          data:[36143,38200],
          backgroundColor:'#16a34a',
          borderColor:'#15803d',
          borderWidth:1, borderRadius:2, borderSkipped:'bottom',
          barPercentage:0.5, categoryPercentage:0.72,
          order:2, datalabels:{display:true}
        },
        // Expense bars ‚Äî dark red, going DOWN (negative values)
        {
          type:'bar', label:'Total Expenses',
          data:[-12275,-11800],
          backgroundColor:'#b91c1c',
          borderColor:'#991b1b',
          borderWidth:1, borderRadius:2, borderSkipped:'top',
          barPercentage:0.5, categoryPercentage:0.72,
          order:2, datalabels:{display:true}
        },
        // Cumulative Net Income line ‚Äî blue
        {
          type:'line', label:'Cumulative Net Income',
          data:[10396,20196],
          borderColor:'#2563eb',
          backgroundColor:'rgba(37,99,235,0.08)',
          borderWidth:3,
          pointBackgroundColor:'#2563eb',
          pointBorderColor:'#fff',
          pointBorderWidth:2,
          pointRadius:7, pointHoverRadius:10,
          tension:0.35, fill:false, order:1,
          datalabels:{
            display:true, align:'top', anchor:'end',
            color:'#1d4ed8', font:{size:12,weight:'bold'},
            formatter: v => '$'+v.toLocaleString()
          }
        }
      ]
    },
    options:{
      responsive:true,
      plugins:{
        datalabels:{ display:true },
        legend:{
          labels:{
            color:'#374151', padding:20, font:{size:12},
            filter: item => !item.text.startsWith('_')
          }
        },
        tooltip:{
          ...tooltipDefaults, mode:'index', intersect:false,
          callbacks:{
            label: ctx => {
              if(ctx.dataset.label.startsWith('_')) return null;
              const v = Math.abs(ctx.parsed.y);
              return ` ${ctx.dataset.label}: $${v.toLocaleString()}`;
            }
          }
        }
      },
      scales:{
        x:{
          ticks:{color:'#8899aa'},
          grid:{color:'rgba(255,255,255,0.05)'},
          grouped: false
        },
        y:{
          ticks:{color:'#8899aa', callback: v => '$'+Math.abs(v).toLocaleString()},
          grid:{color:'rgba(255,255,255,0.05)'},
          suggestedMax:45000,
          suggestedMin:-18000
        }
      }
    }
  });

  restoreChanges();
}

function restoreChanges() {
  const data = loadChanges();
  for (const [id, v] of Object.entries(data)) {
    const badge = document.getElementById('status-' + id);
    if (badge) {
      badge.textContent = v.status;
      badge.className = v.status === 'Resolved' ? 'badge badge-green' : 'badge badge-blue';
    }
    const row = document.getElementById('rr-' + id);
    if (row) row.classList.add('edited');
    const notes = document.getElementById('notes-' + id);
    if (notes && v.notes) notes.value = v.notes;
    const prop = document.getElementById('prop-' + id);
    if (prop && v.property) {
      for (let o of prop.options) { if (o.value === v.property) o.selected = true; }
    }
    const cat = document.getElementById('cat-' + id);
    if (cat && v.category) {
      for (let o of cat.options) { if (o.value === v.category) o.selected = true; }
    }
  }
}

function updateUnresolvedTotal() {
  const rows = document.querySelectorAll('.review-row[data-amount]');
  let total = 0;
  rows.forEach(r => {
    const id = r.id.replace('rr-','');
    const data = loadChanges();
    if (!data[id] || data[id].status !== 'Resolved') {
      total += parseFloat(r.getAttribute('data-amount') || 0);
    }
  });
  const el = document.getElementById('unresolvedTotal');
  if (el) el.textContent = '$' + total.toLocaleString('en-US', {minimumFractionDigits:2});
}
</script>
</div><!-- end main-content -->

<script>
async function checkPw() {
  const val = document.getElementById('pw-input').value;
  const buf = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(val));
  const hash = Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join('');
  if (hash === 'f8779730a98f3f921620d9f0a45dedea858a8e9991104a8703f43125d9ff8b31') {
    sessionStorage.setItem('twcl_auth','1');
    document.getElementById('pw-overlay').style.display='none';
    document.getElementById('main-content').style.display='block';
    requestAnimationFrame(()=>requestAnimationFrame(initDashboard));
  } else {
    document.getElementById('pw-error').style.display='block';
    document.getElementById('pw-input').value='';
  }
}
// Auto-unlock if already authenticated this session
if (sessionStorage.getItem('twcl_auth')==='1') {
  function doUnlock() {
    document.getElementById('pw-overlay').style.display='none';
    document.getElementById('main-content').style.display='block';
    requestAnimationFrame(()=>requestAnimationFrame(initDashboard));
  }
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', doUnlock);
  } else {
    doUnlock();
  }
}

// ========================================================
// STACKED EXPENSE CHART BY PROPERTY & CATEGORY
// ========================================================
var stackedExpenseChartInstance = null;

var stackedData = {
  properties: ['Mesa','13th Ave','5th Dr','38th Dr','Janice Way','Grandview','25th St'],
  propertyIds: ['p1','p2','p3','p5','p6','p7','p8'],
  months: ['Jan 2026','Feb 2026'],
  byPropertyMonth: {
    'p1': { 'Jan 2026': { 'Mortgage': 1066 }, 'Feb 2026': {} },
    'p2': { 'Jan 2026': { 'Mortgage': 2418.35 }, 'Feb 2026': {} },
    'p3': { 'Jan 2026': { 'Mortgage': 2419.48, 'Electric': 54.90, 'Internet': 200, 'Solar': 93 }, 'Feb 2026': { 'Internet': 200 } },
    'p5': { 'Jan 2026': { 'Mortgage': 2594.95, 'Materials': 54.58, 'Repairs': 120, 'Electric': 76.82, 'Gas': 89.90, 'Internet': 32.08 }, 'Feb 2026': { 'Materials': 29.15, 'Internet': 16.04 } },
    'p6': { 'Jan 2026': { 'Landscaping': 364.86, 'Repairs': 320.90, 'Electric': 214.16, 'Gas': 95.47, 'Internet': 215.42 }, 'Feb 2026': { 'Internet': 215.40 } },
    'p7': { 'Jan 2026': { 'Mortgage': 3763, 'Furnishings': 50, 'Landscaping': 965, 'Marketing': 505, 'Materials': 1436.46, 'Repairs': 1860, 'Software': 126.36, 'Electric': 59.25, 'Internet': 156.37 }, 'Feb 2026': { 'Materials': 1010.42 } },
    'p8': { 'Jan 2026': { 'Mortgage': 2420.24, 'Repairs': 120, 'Electric': 127.44, 'Gas': 63.65, 'Internet': 80 }, 'Feb 2026': { 'Materials': 29.15 } }
  }
};

var catColors = {
  'Mortgage':'#ef4444','Electric':'#f97316','Gas':'#eab308','Internet':'#8b5cf6',
  'Solar':'#22c55e','Water':'#06b6d4','Repairs':'#3b82f6','Materials':'#f59e0b',
  'Landscaping':'#84cc16','Cleaning':'#ec4899','Furnishings':'#a78bfa',
  'Marketing':'#fb7185','Software':'#94a3b8','Insurance':'#64748b',
  'VA & Staff':'#c084fc','Legal':'#67e8f9','Travel':'#fde68a','Other':'#475569'
};

function buildStackedDatasets(view) {
  var allCats = Object.keys(catColors);
  var props = stackedData.properties;
  var pIds = stackedData.propertyIds;
  var months = stackedData.months;
  var datasets = [];
  if (view === 'monthly') {
    var labels = [];
    months.forEach(function(m){ props.forEach(function(p){ labels.push(p + ' (' + m.split(' ')[0] + ')'); }); });
    allCats.forEach(function(cat) {
      var vals = [];
      months.forEach(function(m){ pIds.forEach(function(pid){ var d=stackedData.byPropertyMonth[pid][m]||{}; vals.push(d[cat]||0); }); });
      if (!vals.some(function(v){return v>0;})) return;
      datasets.push({ label:cat, data:vals, backgroundColor:catColors[cat]||'#475569', borderColor:'rgba(0,0,0,0.15)', borderWidth:1, borderRadius:3 });
    });
    return { labels:labels, datasets:datasets };
  } else {
    var labels = props;
    allCats.forEach(function(cat) {
      var vals = pIds.map(function(pid){ return months.reduce(function(s,m){ var d=stackedData.byPropertyMonth[pid][m]||{}; return s+(d[cat]||0); },0); });
      if (!vals.some(function(v){return v>0;})) return;
      datasets.push({ label:cat, data:vals, backgroundColor:catColors[cat]||'#475569', borderColor:'rgba(0,0,0,0.15)', borderWidth:1, borderRadius:4 });
    });
    return { labels:labels, datasets:datasets };
  }
}

function buildStackedLegend(datasets) {
  var el = document.getElementById('stackedExpLegend');
  if (!el) return;
  el.innerHTML = datasets.map(function(ds){
    return '<div style="display:flex;align-items:center;gap:6px;font-size:11px;color:#444;">' +
      '<div style="width:12px;height:12px;background:'+ds.backgroundColor+';border-radius:2px;flex-shrink:0;"></div>'+
      '<span>'+ds.label+'</span></div>';
  }).join('');
}

var stackChartOptions = {
  responsive:true, maintainAspectRatio:false,
  plugins: {
    legend:{display:true},
    tooltip:{
      callbacks:{
        title:function(i){return i[0].label;},
        label:function(i){ if(!i.raw||i.raw===0) return null; return ' '+i.dataset.label+': $'+i.raw.toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2}); },
        footer:function(i){ var t=i.reduce(function(s,x){return s+(x.raw||0);},0); return 'Total: $'+t.toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2}); }
      },
      filter:function(i){return i.raw>0;},
      backgroundColor:'rgba(15,20,33,0.95)',titleColor:'#f1f5f9',bodyColor:'#cbd5e1',
      footerColor:'#3b82f6',borderColor:'#3b82f6',borderWidth:1,padding:12,cornerRadius:8
    }
  },
  scales:{
    x:{stacked:true, ticks:{color:'#94a3b8',font:{size:10},maxRotation:30}, grid:{color:'rgba(255,255,255,0.04)'}},
    y:{stacked:true, ticks:{color:'#94a3b8',font:{size:11},callback:function(v){return '$'+(v/1000).toFixed(0)+'k';}}, grid:{color:'rgba(255,255,255,0.07)'}}
  }
};

function setStackView(view) {
  document.getElementById('btnStackMonthly').style.background = view==='monthly'?'#3b82f6':'#2d3448';
  document.getElementById('btnStackMonthly').style.color = view==='monthly'?'#fff':'#94a3b8';
  document.getElementById('btnStackAnnual').style.background = view==='annual'?'#3b82f6':'#2d3448';
  document.getElementById('btnStackAnnual').style.color = view==='annual'?'#fff':'#94a3b8';
  var built = buildStackedDatasets(view);
  buildStackedLegend(built.datasets);
  if (stackedExpenseChartInstance) {
    stackedExpenseChartInstance.data.labels = built.labels;
    stackedExpenseChartInstance.data.datasets = built.datasets;
    stackedExpenseChartInstance.update('active');
  }
}

function initStackedExpenseChart() {
  var ctx = document.getElementById('stackedExpenseChart');
  if (!ctx) return;
  var built = buildStackedDatasets('monthly');
  buildStackedLegend(built.datasets);
  stackedExpenseChartInstance = new Chart(ctx, { type:'bar', data:{ labels:built.labels, datasets:built.datasets }, options:stackChartOptions });
}



// ===== PROPERTY CHARTS TAB =====
var propChartInstance = null;
var currentPropId = 'p3';
var currentPropMonth = '2026-01';
var roomData = {"p3":{"2026-01":{"Rm 2":{"tenant":"Joshua Mcgeathy","dues":748.0,"late_fees":100.0,"booking_fees":0.0,"service_fees":67.84,"txn_fees":0.0,"host_earnings":780.16,"gross":848.0,"source":"PadSplit","late_flag":true},"Rm 6":{"tenant":"James Miller","dues":940.0,"late_fees":0,"booking_fees":0.0,"service_fees":116.8284,"txn_fees":0.92317,"host_earnings":855.81842,"gross":973.5699999999999,"source":"PadSplit","late_flag":false},"Rm 4":{"tenant":"Scott Alexander","dues":1045.0,"late_fees":50.0,"booking_fees":0.0,"service_fees":131.4,"txn_fees":30.1125,"host_earnings":933.4875,"gross":1095.0,"source":"PadSplit","late_flag":true},"Rm 5":{"tenant":"Benjamin Garcia","dues":816.0,"late_fees":0,"booking_fees":0.0,"service_fees":65.28,"txn_fees":0.0,"host_earnings":750.72,"gross":816.0,"source":"PadSplit","late_flag":false},"Rm 3":{"tenant":"Antonio Acosta","dues":876.0,"late_fees":0,"booking_fees":0.0,"service_fees":105.12,"txn_fees":24.09,"host_earnings":746.79,"gross":876.0,"source":"PadSplit","late_flag":false},"Rm 1":{"tenant":"Margaret Phillips","dues":860.0,"late_fees":0,"booking_fees":0.0,"service_fees":103.2,"txn_fees":23.65,"host_earnings":733.15,"gross":860.0,"source":"PadSplit","late_flag":false}},"2026-02":{"Rm 2":{"tenant":"Joshua Mcgeathy","dues":935.0,"late_fees":100.0,"booking_fees":0.0,"service_fees":82.80000000000001,"txn_fees":0.0,"host_earnings":952.2,"gross":1035.0,"source":"PadSplit","late_flag":true},"Rm 6":{"tenant":"James Miller","dues":939.0,"late_fees":0,"booking_fees":0.0,"service_fees":112.68,"txn_fees":0.0,"host_earnings":826.3199999999999,"gross":939.0,"source":"PadSplit","late_flag":false},"Rm 4":{"tenant":"Scott Alexander","dues":860.0,"late_fees":0,"booking_fees":0.0,"service_fees":103.2,"txn_fees":23.65,"host_earnings":733.15,"gross":860.0,"source":"PadSplit","late_flag":false},"Rm 3":{"tenant":"Antonio Acosta","dues":876.0,"late_fees":0,"booking_fees":0.0,"service_fees":105.12,"txn_fees":24.09,"host_earnings":746.79,"gross":876.0,"source":"PadSplit","late_flag":false},"Rm 5":{"tenant":"Benjamin Garcia","dues":816.0,"late_fees":0,"booking_fees":0.0,"service_fees":65.28,"txn_fees":0.0,"host_earnings":750.72,"gross":816.0,"source":"PadSplit","late_flag":false},"Rm 1":{"tenant":"Margaret Phillips","dues":860.0,"late_fees":0,"booking_fees":0.0,"service_fees":103.2,"txn_fees":23.65,"host_earnings":733.15,"gross":860.0,"source":"PadSplit","late_flag":false}},"YTD":{"Rm 2":{"tenant":"Joshua Mcgeathy","dues":1683.0,"late_fees":200.0,"booking_fees":0.0,"service_fees":150.64,"txn_fees":0.0,"host_earnings":1732.36,"gross":1883.0,"source":"PadSplit","late_flag":true},"Rm 5":{"tenant":"Benjamin Garcia","dues":1632.0,"late_fees":0,"booking_fees":0.0,"service_fees":130.56,"txn_fees":0.0,"host_earnings":1501.44,"gross":1632.0,"source":"PadSplit","late_flag":false},"Rm 4":{"tenant":"Scott Alexander","dues":1905.0,"late_fees":50.0,"booking_fees":0.0,"service_fees":234.6,"txn_fees":53.76,"host_earnings":1666.64,"gross":1955.0,"source":"PadSplit","late_flag":true},"Rm 1":{"tenant":"Margaret Phillips","dues":1720.0,"late_fees":0,"booking_fees":0.0,"service_fees":206.4,"txn_fees":47.3,"host_earnings":1466.3,"gross":1720.0,"source":"PadSplit","late_flag":false},"Rm 6":{"tenant":"James Miller","dues":1879.0,"late_fees":0,"booking_fees":0.0,"service_fees":229.51,"txn_fees":0.92,"host_earnings":1682.14,"gross":1912.57,"source":"PadSplit","late_flag":false},"Rm 3":{"tenant":"Antonio Acosta","dues":1752.0,"late_fees":0,"booking_fees":0.0,"service_fees":210.24,"txn_fees":48.18,"host_earnings":1493.58,"gross":1752.0,"source":"PadSplit","late_flag":false}}},"p6":{"2026-01":{"Rm 2":{"tenant":"John Lee","dues":1075.0,"late_fees":0,"booking_fees":0.0,"service_fees":86.0,"txn_fees":0.0,"host_earnings":989.0,"gross":1075.0,"source":"PadSplit","late_flag":false},"Rm 4":{"tenant":"Drake White","dues":860.0,"late_fees":0,"booking_fees":0.0,"service_fees":68.8,"txn_fees":0.0,"host_earnings":791.2,"gross":860.0,"source":"PadSplit","late_flag":false},"Rm 1":{"tenant":"Sergey Woudenberg","dues":856.0,"late_fees":0,"booking_fees":0.0,"service_fees":68.48,"txn_fees":0.0,"host_earnings":787.52,"gross":856.0,"source":"PadSplit","late_flag":false},"Rm 3":{"tenant":"Crandall Head","dues":388.14,"late_fees":0,"booking_fees":298.58,"service_fees":22.4,"txn_fees":0.0,"host_earnings":202.6576,"gross":518.86,"source":"PadSplit","late_flag":false},"Rm 8":{"tenant":"Terry Grice","dues":923.95,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":923.95,"gross":923.95,"source":"Direct/Rent Perfect","late_flag":false},"Rm 6":{"tenant":"Michael Little","dues":980.0,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":980.0,"gross":980.0,"source":"Direct/Rent Perfect","late_flag":false},"Rm 5":{"tenant":"(Vacant)","dues":0,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":0,"gross":0,"source":"\u2014"},"Rm 7":{"tenant":"(Vacant)","dues":0,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":0,"gross":0,"source":"\u2014"}},"2026-02":{"Rm 4":{"tenant":"Drake White","dues":860.0,"late_fees":0,"booking_fees":0.0,"service_fees":68.8,"txn_fees":0.0,"host_earnings":791.2,"gross":860.0,"source":"PadSplit","late_flag":false},"Rm 1":{"tenant":"Sergey Woudenberg","dues":856.0,"late_fees":0,"booking_fees":0.0,"service_fees":68.48,"txn_fees":0.0,"host_earnings":787.52,"gross":856.0,"source":"PadSplit","late_flag":false},"Rm 7":{"tenant":"Michael Witt","dues":0.0,"late_fees":0,"booking_fees":0.0,"service_fees":31.04,"txn_fees":0.0,"host_earnings":0.0,"gross":0.0,"source":"PadSplit","late_flag":false},"Rm 2":{"tenant":"John Lee","dues":645.0,"late_fees":0,"booking_fees":0.0,"service_fees":51.599999999999994,"txn_fees":0.0,"host_earnings":593.4000000000001,"gross":645.0,"source":"PadSplit","late_flag":false},"Rm 5":{"tenant":"Michelle Winquist","dues":201.42999999999998,"late_fees":0,"booking_fees":201.42999999999998,"service_fees":5.52,"txn_fees":0.0,"host_earnings":63.48,"gross":270.42999999999995,"source":"PadSplit","late_flag":false},"Rm 3":{"tenant":"Nathaniel Delmont","dues":0.0,"late_fees":0,"booking_fees":0.0,"service_fees":37.4736,"txn_fees":0.0,"host_earnings":23.0,"gross":25.000000000000007,"source":"PadSplit","late_flag":false},"Rm 6":{"tenant":"Michael Little","dues":980.0,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":980.0,"gross":980.0,"source":"Direct/Rent Perfect","late_flag":false},"Rm 8":{"tenant":"Terry Grice","dues":963.95,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":963.95,"gross":963.95,"source":"Direct/Rent Perfect","late_flag":false}},"YTD":{"Rm 2":{"tenant":"John Lee","dues":1720.0,"late_fees":0,"booking_fees":0.0,"service_fees":137.6,"txn_fees":0.0,"host_earnings":1582.4,"gross":1720.0,"source":"PadSplit","late_flag":false},"Rm 8":{"tenant":"Terry Grice","dues":1887.9,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":1887.9,"gross":1887.9,"source":"Direct/Rent Perfect","late_flag":false},"Rm 7":{"tenant":"Michael Witt","dues":0.0,"late_fees":0,"booking_fees":0.0,"service_fees":31.04,"txn_fees":0.0,"host_earnings":0.0,"gross":0.0,"source":"PadSplit","late_flag":false},"Rm 5":{"tenant":"Michelle Winquist","dues":201.42999999999998,"late_fees":0,"booking_fees":201.43,"service_fees":5.52,"txn_fees":0.0,"host_earnings":63.48,"gross":270.42999999999995,"source":"PadSplit","late_flag":false},"Rm 4":{"tenant":"Drake White","dues":1720.0,"late_fees":0,"booking_fees":0.0,"service_fees":137.6,"txn_fees":0.0,"host_earnings":1582.4,"gross":1720.0,"source":"PadSplit","late_flag":false},"Rm 1":{"tenant":"Sergey Woudenberg","dues":1712.0,"late_fees":0,"booking_fees":0.0,"service_fees":136.96,"txn_fees":0.0,"host_earnings":1575.04,"gross":1712.0,"source":"PadSplit","late_flag":false},"Rm 6":{"tenant":"Michael Little","dues":1960.0,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":1960.0,"gross":1960.0,"source":"Direct/Rent Perfect","late_flag":false},"Rm 3":{"tenant":"Crandall Head","dues":388.14,"late_fees":0,"booking_fees":298.58,"service_fees":59.87,"txn_fees":0.0,"host_earnings":225.66,"gross":543.86,"source":"PadSplit","late_flag":false}}},"p5":{"2026-01":{"Rm 2":{"tenant":"Anthony Shivers II","dues":995.0,"late_fees":0,"booking_fees":0.0,"service_fees":79.6,"txn_fees":0.0,"host_earnings":915.4000000000001,"gross":995.0,"source":"PadSplit","late_flag":false},"Rm 3":{"tenant":"Phillip South","dues":158.57,"late_fees":0,"booking_fees":0.0,"service_fees":16.9144,"txn_fees":0.0,"host_earnings":145.8844,"gross":158.57,"source":"PadSplit","late_flag":false},"Rm 1":{"tenant":"Dandrine Strachan","dues":860.0,"late_fees":25.0,"booking_fees":0.0,"service_fees":70.8,"txn_fees":0.0,"host_earnings":814.2,"gross":885.0,"source":"PadSplit","late_flag":true},"Rm 5":{"tenant":"Aiyh Abu Zour","dues":764.0,"late_fees":0,"booking_fees":0.0,"service_fees":61.12,"txn_fees":0.0,"host_earnings":702.88,"gross":764.0,"source":"PadSplit","late_flag":false},"Rm 7":{"tenant":"JaNiya Price","dues":1015.4799999999999,"late_fees":125.0,"booking_fees":0.0,"service_fees":91.23840000000001,"txn_fees":0.0,"host_earnings":1049.2416,"gross":1140.48,"source":"PadSplit","late_flag":true},"Rm 4":{"tenant":"Selyna","dues":1125.0,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":1125.0,"gross":1125.0,"source":"Direct/Venmo","late_flag":false}},"2026-02":{"Rm 1":{"tenant":"Dandrine Strachan","dues":860.0,"late_fees":0,"booking_fees":0.0,"service_fees":68.8,"txn_fees":0.0,"host_earnings":791.2,"gross":860.0,"source":"PadSplit","late_flag":false},"Rm 7":{"tenant":"JaNiya Price","dues":704.52,"late_fees":75.0,"booking_fees":0.0,"service_fees":62.3616,"txn_fees":0.0,"host_earnings":717.1584,"gross":779.52,"source":"PadSplit","late_flag":true},"Rm 5":{"tenant":"Aiyh Abu Zour","dues":764.0,"late_fees":0,"booking_fees":0.0,"service_fees":61.12,"txn_fees":0.0,"host_earnings":702.88,"gross":764.0,"source":"PadSplit","late_flag":false},"Rm 2":{"tenant":"Anthony Shivers II","dues":597.0,"late_fees":25.0,"booking_fees":0.0,"service_fees":49.760000000000005,"txn_fees":0.0,"host_earnings":572.24,"gross":622.0,"source":"PadSplit","late_flag":true},"Rm 6":{"tenant":"Alissa Inabinet Cruz","dues":402.82,"late_fees":25.0,"booking_fees":0.0,"service_fees":34.2256,"txn_fees":0.0,"host_earnings":393.5944,"gross":427.82,"source":"PadSplit","late_flag":true},"Rm 3":{"tenant":"Neysha Alston","dues":184.0,"late_fees":0,"booking_fees":184.0,"service_fees":0.0,"txn_fees":0.0,"host_earnings":0.0,"gross":184.0,"source":"PadSplit","late_flag":false},"Rm 4":{"tenant":"Selyna","dues":925.0,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":925.0,"gross":925.0,"source":"Direct/Venmo","late_flag":false}},"YTD":{"Rm 2":{"tenant":"Anthony Shivers II","dues":1592.0,"late_fees":25.0,"booking_fees":0.0,"service_fees":129.36,"txn_fees":0.0,"host_earnings":1487.64,"gross":1617.0,"source":"PadSplit","late_flag":true},"Rm 7":{"tenant":"JaNiya Price","dues":1720.0,"late_fees":200.0,"booking_fees":0.0,"service_fees":153.6,"txn_fees":0.0,"host_earnings":1766.4,"gross":1920.0,"source":"PadSplit","late_flag":true},"Rm 5":{"tenant":"Aiyh Abu Zour","dues":1528.0,"late_fees":0,"booking_fees":0.0,"service_fees":122.24,"txn_fees":0.0,"host_earnings":1405.76,"gross":1528.0,"source":"PadSplit","late_flag":false},"Rm 4":{"tenant":"Selyna","dues":2050.0,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":2050.0,"gross":2050.0,"source":"Direct/Venmo","late_flag":false},"Rm 1":{"tenant":"Dandrine Strachan","dues":1720.0,"late_fees":25.0,"booking_fees":0.0,"service_fees":139.6,"txn_fees":0.0,"host_earnings":1605.4,"gross":1745.0,"source":"PadSplit","late_flag":true},"Rm 6":{"tenant":"Alissa Inabinet Cruz","dues":402.82,"late_fees":25.0,"booking_fees":0.0,"service_fees":34.23,"txn_fees":0.0,"host_earnings":393.59,"gross":427.82,"source":"PadSplit","late_flag":true},"Rm 3":{"tenant":"Phillip South","dues":342.57,"late_fees":0,"booking_fees":184.0,"service_fees":16.91,"txn_fees":0.0,"host_earnings":145.88,"gross":342.57,"source":"PadSplit","late_flag":false}}},"p8":{"2026-01":{"Rm 2":{"tenant":"Michael Smith","dues":844.0,"late_fees":125.0,"booking_fees":0.0,"service_fees":77.52,"txn_fees":0.0,"host_earnings":891.48,"gross":969.0,"source":"PadSplit","late_flag":true},"Rm 4":{"tenant":"Thorvald Cadman","dues":776.0,"late_fees":0,"booking_fees":0.0,"service_fees":62.08,"txn_fees":0.0,"host_earnings":713.92,"gross":776.0,"source":"PadSplit","late_flag":false},"Rm 5":{"tenant":"Aaron Owens","dues":988.0,"late_fees":100.0,"booking_fees":0.0,"service_fees":87.03999999999999,"txn_fees":0.0,"host_earnings":1000.96,"gross":1088.0,"source":"PadSplit","late_flag":true},"Rm 1":{"tenant":"Noah Yang","dues":820.0,"late_fees":0,"booking_fees":0.0,"service_fees":65.6,"txn_fees":0.0,"host_earnings":754.4,"gross":820.0,"source":"PadSplit","late_flag":false},"Rm 3":{"tenant":"Victor Sesmas","dues":890.0,"late_fees":75.0,"booking_fees":0.0,"service_fees":77.19999999999999,"txn_fees":0.0,"host_earnings":887.8000000000001,"gross":965.0,"source":"PadSplit","late_flag":true},"Rm 6":{"tenant":"Isaiah Reyes (via Lilliana)","dues":903.95,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":903.95,"gross":903.95,"source":"Direct/Rent Perfect","late_flag":false},"Rm 7":{"tenant":"(Vacant)","dues":0,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":0,"gross":0,"source":"\u2014"}},"2026-02":{"Rm 3":{"tenant":"Victor Sesmas","dues":926.0,"late_fees":50.0,"booking_fees":0.0,"service_fees":83.2688,"txn_fees":0.0,"host_earnings":957.5912000000001,"gross":1040.8600000000001,"source":"PadSplit","late_flag":true},"Rm 5":{"tenant":"Aaron Owens","dues":561.0,"late_fees":50.0,"booking_fees":0.0,"service_fees":48.879999999999995,"txn_fees":0.0,"host_earnings":562.12,"gross":611.0,"source":"PadSplit","late_flag":true},"Rm 4":{"tenant":"Thorvald Cadman","dues":776.0,"late_fees":0,"booking_fees":0.0,"service_fees":62.08,"txn_fees":0.0,"host_earnings":713.92,"gross":776.0,"source":"PadSplit","late_flag":false},"Rm 1":{"tenant":"Noah Yang","dues":820.0,"late_fees":0,"booking_fees":0.0,"service_fees":65.6,"txn_fees":0.0,"host_earnings":754.4000000000001,"gross":820.0,"source":"PadSplit","late_flag":false},"Rm 2":{"tenant":"Michael Smith","dues":539.0,"late_fees":50.0,"booking_fees":0.0,"service_fees":47.12,"txn_fees":0.0,"host_earnings":541.88,"gross":589.0,"source":"PadSplit","late_flag":true},"Rm 6":{"tenant":"Isaiah Reyes (via Lilliana)","dues":903.95,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":903.95,"gross":903.95,"source":"Direct/Rent Perfect","late_flag":false},"Rm 7":{"tenant":"Conor Hart","dues":1235.59,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":1235.59,"gross":1235.59,"source":"Airbnb"}},"YTD":{"Rm 2":{"tenant":"Michael Smith","dues":1383.0,"late_fees":175.0,"booking_fees":0.0,"service_fees":124.64,"txn_fees":0.0,"host_earnings":1433.36,"gross":1558.0,"source":"PadSplit","late_flag":true},"Rm 5":{"tenant":"Aaron Owens","dues":1549.0,"late_fees":150.0,"booking_fees":0.0,"service_fees":135.92,"txn_fees":0.0,"host_earnings":1563.08,"gross":1699.0,"source":"PadSplit","late_flag":true},"Rm 4":{"tenant":"Thorvald Cadman","dues":1552.0,"late_fees":0,"booking_fees":0.0,"service_fees":124.16,"txn_fees":0.0,"host_earnings":1427.84,"gross":1552.0,"source":"PadSplit","late_flag":false},"Rm 1":{"tenant":"Noah Yang","dues":1640.0,"late_fees":0,"booking_fees":0.0,"service_fees":131.2,"txn_fees":0.0,"host_earnings":1508.8,"gross":1640.0,"source":"PadSplit","late_flag":false},"Rm 6":{"tenant":"Isaiah Reyes (via Lilliana)","dues":1807.9,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":1807.9,"gross":1807.9,"source":"Direct/Rent Perfect","late_flag":false},"Rm 3":{"tenant":"Victor Sesmas","dues":1816.0,"late_fees":125.0,"booking_fees":0.0,"service_fees":160.47,"txn_fees":0.0,"host_earnings":1845.39,"gross":2005.86,"source":"PadSplit","late_flag":true},"Rm 7":{"tenant":"Conor Hart","dues":1235.59,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":1235.59,"gross":1235.59,"source":"Airbnb"}}},"p7":{"2026-01":{"Rm 6":{"tenant":"Luke Card","dues":399.85,"late_fees":0,"booking_fees":282.86,"service_fees":9.3592,"txn_fees":0.0,"host_earnings":107.63080000000001,"gross":399.85,"source":"PadSplit","late_flag":false},"Rm 4":{"tenant":"Alissa Inabinet Cruz","dues":615.14,"late_fees":0,"booking_fees":334.29,"service_fees":22.467999999999996,"txn_fees":0.0,"host_earnings":258.382,"gross":615.14,"source":"PadSplit","late_flag":false},"Rm 7":{"tenant":"Kwuanshele McKinnies","dues":261.71,"late_fees":0,"booking_fees":261.71,"service_fees":0.0,"txn_fees":0.0,"host_earnings":0.0,"gross":261.71,"source":"PadSplit","late_flag":false},"Rm 2":{"tenant":"Jesse Mink","dues":186.58999999999997,"late_fees":0,"booking_fees":186.58999999999997,"service_fees":0.0,"txn_fees":0.0,"host_earnings":0.0,"gross":186.58999999999997,"source":"PadSplit","late_flag":false},"Rm 3":{"tenant":"Gary Connor","dues":100.0,"late_fees":0,"booking_fees":100.0,"service_fees":0.0,"txn_fees":0.0,"host_earnings":0.0,"gross":100.0,"source":"PadSplit","late_flag":false},"Rm 5":{"tenant":"Jerrod Jesse (Jarrett)","dues":1120.0,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":1120.0,"gross":1120.0,"source":"Direct/Zelle","late_flag":false},"Rm 1":{"tenant":"(Vacant)","dues":0,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":0,"gross":0,"source":"\u2014"}},"2026-02":{"Rm 3":{"tenant":"Gary Connor","dues":757.5699999999999,"late_fees":0,"booking_fees":195.72,"service_fees":44.94799999999999,"txn_fees":0.0,"host_earnings":516.902,"gross":757.5699999999999,"source":"PadSplit","late_flag":false},"Rm 2":{"tenant":"Isaiah Johnson","dues":669.4200000000001,"late_fees":0,"booking_fees":333.14,"service_fees":63.5864,"txn_fees":0.0,"host_earnings":393.7508,"gross":761.13,"source":"PadSplit","late_flag":false},"Rm 4":{"tenant":"Hannah Langford","dues":354.28,"late_fees":0,"booking_fees":234.0,"service_fees":31.0176,"txn_fees":0.0,"host_earnings":110.6576,"gross":354.28,"source":"PadSplit","late_flag":false},"Rm 7":{"tenant":"Kwuanshele McKinnies","dues":916.0,"late_fees":0,"booking_fees":65.44,"service_fees":68.04480000000001,"txn_fees":0.0,"host_earnings":782.5152,"gross":916.0,"source":"PadSplit","late_flag":false},"Rm 6":{"tenant":"Luke Card","dues":788.15,"late_fees":0,"booking_fees":0.0,"service_fees":63.05200000000001,"txn_fees":0.0,"host_earnings":725.098,"gross":788.15,"source":"PadSplit","late_flag":false},"Rm 5":{"tenant":"Jerrod Jesse (Jarrett)","dues":1200.0,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":1200.0,"gross":1200.0,"source":"Direct/Zelle","late_flag":false},"Rm 1":{"tenant":"Omar Hamad","dues":900.0,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":900.0,"gross":900.0,"source":"Direct"}},"YTD":{"Rm 2":{"tenant":"Jesse Mink","dues":856.01,"late_fees":0,"booking_fees":519.73,"service_fees":63.59,"txn_fees":0.0,"host_earnings":393.75,"gross":947.72,"source":"PadSplit","late_flag":false},"Rm 7":{"tenant":"Kwuanshele McKinnies","dues":1177.71,"late_fees":0,"booking_fees":327.15,"service_fees":68.04,"txn_fees":0.0,"host_earnings":782.52,"gross":1177.71,"source":"PadSplit","late_flag":false},"Rm 5":{"tenant":"Jerrod Jesse (Jarrett)","dues":2320.0,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":2320.0,"gross":2320.0,"source":"Direct/Zelle","late_flag":false},"Rm 4":{"tenant":"Alissa Inabinet Cruz","dues":969.42,"late_fees":0,"booking_fees":568.29,"service_fees":53.49,"txn_fees":0.0,"host_earnings":369.04,"gross":969.42,"source":"PadSplit","late_flag":false},"Rm 1":{"tenant":"Omar Hamad","dues":900.0,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":900.0,"gross":900.0,"source":"Direct","late_flag":false},"Rm 6":{"tenant":"Luke Card","dues":1188.0,"late_fees":0,"booking_fees":282.86,"service_fees":72.41,"txn_fees":0.0,"host_earnings":832.73,"gross":1188.0,"source":"PadSplit","late_flag":false},"Rm 3":{"tenant":"Gary Connor","dues":857.57,"late_fees":0,"booking_fees":295.72,"service_fees":44.95,"txn_fees":0.0,"host_earnings":516.9,"gross":857.57,"source":"PadSplit","late_flag":false}}},"p1":{"2026-01":{"Full Unit":{"tenant":"Ricardo Vizcarra","dues":2113.95,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":2113.95,"gross":2113.95,"source":"LTR/Rent Perfect","late_flag":false}},"2026-02":{"Full Unit":{"tenant":"Ricardo Vizcarra","dues":2113.95,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":2113.95,"gross":2113.95,"source":"LTR/Zelle","late_flag":false}},"YTD":{"Full Unit":{"tenant":"Ricardo Vizcarra","dues":4227.9,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":4227.9,"gross":4227.9,"source":"LTR/Rent Perfect","late_flag":false}}},"p2":{"2026-01":{"Full Unit":{"tenant":"Ian Decker","dues":2480.0,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":2480.0,"gross":2480.0,"source":"LTR/Rent Perfect","late_flag":false}},"2026-02":{"Full Unit":{"tenant":"Ian Decker","dues":2480.0,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":2480.0,"gross":2480.0,"source":"LTR/Rent Perfect","late_flag":false}},"YTD":{"Full Unit":{"tenant":"Ian Decker","dues":4960.0,"late_fees":0,"booking_fees":0,"service_fees":0,"txn_fees":0,"host_earnings":4960.0,"gross":4960.0,"source":"LTR/Rent Perfect","late_flag":false}}}};
var propLabels = {"p1": "Mesa (LTR)", "p2": "13th Ave (LTR)", "p3": "19817 N 5th Dr", "p5": "14802 N 38th Dr", "p6": "2302 E Janice Way", "p7": "4029 W Grandview Rd", "p8": "8229 S 25th St"};
var propOrder = ["p3", "p5", "p6", "p7", "p8", "p1", "p2"];

function selectPropChart(pid) {
  currentPropId = pid;
  propOrder.forEach(function(p) {
    var btn = document.getElementById('pct-' + p);
    if (btn) btn.style.cssText = btn.style.cssText.replace(/background:[^;]+/, 'background:#e2e8f0').replace(/color:[^;]+/, 'color:#475569');
  });
  var activeBtn = document.getElementById('pct-' + pid);
  if (activeBtn) { activeBtn.style.background = '#6366f1'; activeBtn.style.color = '#fff'; }
  renderPropChart();
}

function selectPropMonth(month) {
  currentPropMonth = month;
  ['2026-01','2026-02','YTD'].forEach(function(m) {
    var btn = document.getElementById('pm-' + m);
    if (btn) { btn.style.background = '#e2e8f0'; btn.style.color = '#475569'; }
  });
  var activeBtn = document.getElementById('pm-' + month);
  if (activeBtn) { activeBtn.style.background = '#3b82f6'; activeBtn.style.color = '#fff'; }
  renderPropChart();
}

function renderPropChart() {
  var pid = currentPropId;
  var month = currentPropMonth;
  var propData = (roomData[pid] && roomData[pid][month]) ? roomData[pid][month] : {};
  
  // Sort rooms
  var rooms = Object.keys(propData).sort(function(a,b) {
    var na = parseInt(a.replace(/\D/g,'')) || 0;
    var nb = parseInt(b.replace(/\D/g,'')) || 0;
    return na - nb;
  });

  var labels = rooms;
  var duesData = rooms.map(function(r) { return Math.round(propData[r].dues * 100)/100; });
  var lateData = rooms.map(function(r) { return Math.round(propData[r].late_fees * 100)/100; });
  var netData = rooms.map(function(r) { return Math.round(propData[r].host_earnings * 100)/100; });
  var bgColors = rooms.map(function(r) { return propData[r].late_flag ? '#fef2f2' : '#f0f4ff'; });

  // Title
  var monthLabel = month === 'YTD' ? 'Year-to-Date 2026' : (month === '2026-01' ? 'January 2026' : 'February 2026 (partial)');
  document.getElementById('propChartTitle').textContent = propLabels[pid] + ' ‚Äî ' + monthLabel;

  // Destroy old chart
  if (propChartInstance) { propChartInstance.destroy(); propChartInstance = null; }

  var ctx = document.getElementById('propRoomChart').getContext('2d');
  propChartInstance = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: labels,
      datasets: [
        {
          label: 'Base Dues',
          data: duesData,
          backgroundColor: '#4f46e5',
          borderRadius: 4,
          stack: 'stack0'
        },
        {
          label: 'Late Fees',
          data: lateData,
          backgroundColor: '#dc2626',
          borderRadius: 4,
          stack: 'stack0'
        },
        {
          label: 'Net to Host',
          data: netData,
          backgroundColor: '#059669',
          borderColor: '#047857',
          borderWidth: 1.5,
          borderRadius: 4,
          borderDash: [],
          type: 'bar',
          stack: 'stack0'
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { position: 'top', labels: { font: { size: 11 } } },
        tooltip: {
          callbacks: {
            title: function(items) {
              var room = items[0].label;
              var d = propData[room];
              return room + (d ? ' ‚Äî ' + d.tenant : '');
            },
            afterBody: function(items) {
              var room = items[0].label;
              var d = propData[room];
              if (!d) return [];
              var lines = [
                'Gross Collected: $' + d.gross.toFixed(2),
                'Platform Fees: $' + (d.booking_fees + d.service_fees + d.txn_fees).toFixed(2),
                'Net to Host: $' + d.host_earnings.toFixed(2),
                'Source: ' + d.source
              ];
              if (d.late_fees > 0) lines.push('‚ö†Ô∏è Late Fees: $' + d.late_fees.toFixed(2));
              return lines;
            }
          }
        },
        datalabels: {
          display: function(ctx) { return ctx.datasetIndex === 0 && ctx.dataset.data[ctx.dataIndex] > 0; },
          formatter: function(v) { return '$' + v.toFixed(0); },
          color: '#222', font: { size: 10, weight: 'bold' },
          anchor: 'center', align: 'center'
        }
      },
      scales: {
        x: { stacked: true, grid: { display: true }, ticks: { font: { size: 11 } } },
        y: { stacked: false, ticks: { callback: function(v) { return '$' + v.toLocaleString(); }, font: { size: 10 } }, grid: { color: '#f1f5f9' } }
      }
    }
  });

  // Build detail table
  var tbody = document.getElementById('propRoomTableBody');
  var tfoot = document.getElementById('propRoomTableFoot');
  tbody.innerHTML = '';
  var totDues=0, totLate=0, totPlatform=0, totNet=0, lateRooms=[];

  rooms.forEach(function(room) {
    var d = propData[room];
    var platform = Math.round((d.booking_fees + d.service_fees + d.txn_fees)*100)/100;
    totDues += d.dues; totLate += d.late_fees; totPlatform += platform; totNet += d.host_earnings;
    if (d.late_flag) lateRooms.push(room + ' (' + d.tenant + ')');

    var srcColor = '#6366f1';
    if (d.source.includes('Venmo')) srcColor = '#f59e0b';
    else if (d.source.includes('Zelle')) srcColor = '#3b82f6';
    else if (d.source.includes('LTR')) srcColor = '#8b5cf6';
    else if (d.source.includes('Direct')) srcColor = '#10b981';

    var statusBadge = d.late_flag 
      ? '<span style="background:#fef2f2;color:#444;padding:2px 8px;border-radius:10px;font-size:0.72rem;font-weight:700;">‚ö†Ô∏è Late</span>'
      : '<span style="background:#f0fdf4;color:#16a34a;padding:2px 8px;border-radius:10px;font-size:0.72rem;font-weight:600;">‚úì On Time</span>';
    if (d.host_earnings <= 0) statusBadge = '<span style="background:#fafafa;color:#94a3b8;padding:2px 8px;border-radius:10px;font-size:0.72rem;">No Payout</span>';

    var rowBg = d.late_flag ? '#fffbfb' : '#fff';
    tbody.innerHTML += '<tr style="border-bottom:1px solid #f1f5f9;background:' + rowBg + ';">' +
      '<td style="padding:8px 10px;font-weight:700;color:#1e293b;">' + room + '</td>' +
      '<td style="padding:8px 10px;color:#475569;">' + d.tenant + '</td>' +
      '<td style="padding:8px 10px;text-align:right;color:#374151;">$' + d.dues.toFixed(2) + '</td>' +
      '<td style="padding:8px 10px;text-align:right;color:' + (d.late_fees>0?'#ef4444':'#94a3b8') + ';font-weight:' + (d.late_fees>0?'700':'400') + ';">' + (d.late_fees>0?'$'+d.late_fees.toFixed(2):'-') + '</td>' +
      '<td style="padding:8px 10px;text-align:right;color:#6b7280;">' + (platform>0?'$'+platform.toFixed(2):'-') + '</td>' +
      '<td style="padding:8px 10px;text-align:right;font-weight:700;color:#10b981;">$' + d.host_earnings.toFixed(2) + '</td>' +
      '<td style="padding:8px 10px;text-align:center;"><span style="background:' + srcColor + '20;color:' + srcColor + ';padding:2px 7px;border-radius:10px;font-size:0.72rem;font-weight:600;">' + d.source + '</span></td>' +
      '<td style="padding:8px 10px;text-align:center;">' + statusBadge + '</td>' +
      '</tr>';
  });

  tfoot.innerHTML = '<tr style="background:#f8fafc;border-top:2px solid #e2e8f0;font-weight:700;">' +
    '<td style="padding:9px 10px;color:#1e293b;" colspan="2">TOTAL</td>' +
    '<td style="padding:9px 10px;text-align:right;color:#374151;">$' + totDues.toFixed(2) + '</td>' +
    '<td style="padding:9px 10px;text-align:right;color:#ef4444;">$' + totLate.toFixed(2) + '</td>' +
    '<td style="padding:9px 10px;text-align:right;color:#6b7280;">$' + totPlatform.toFixed(2) + '</td>' +
    '<td style="padding:9px 10px;text-align:right;color:#10b981;">$' + totNet.toFixed(2) + '</td>' +
    '<td colspan="2"></td></tr>';

  // Late fees summary
  var lsEl = document.getElementById('lateFeesSummary');
  if (lateRooms.length > 0) {
    lsEl.innerHTML = '<div style="padding:12px 16px;background:#fef2f2;border-left:3px solid #ef4444;border-radius:6px;font-size:0.82rem;color:#7f1d1d;">' +
      '<strong>‚ö†Ô∏è Late Payments (' + lateRooms.length + ' room' + (lateRooms.length>1?'s':'') + '):</strong> ' + lateRooms.join(', ') +
      '<span style="margin-left:8px;color:#444;">Total late fees: $' + totLate.toFixed(2) + '</span></div>';
  } else {
    lsEl.innerHTML = '<div style="padding:10px 16px;background:#f0fdf4;border-left:3px solid #10b981;border-radius:6px;font-size:0.82rem;color:#14532d;">' +
      '‚úì No late fees for this property/period.</div>';
  }
}

function initPropCharts() {
  renderPropChart();
}

</script>

</body>
</html>
